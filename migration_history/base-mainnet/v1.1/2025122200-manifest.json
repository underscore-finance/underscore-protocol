{
  "contracts": {
    "LegoBook": {
      "address": "0x0f149c37714201400A279A31B7E2057cB1491153",
      "abi": [
        {
          "name": "GovChangeTimeLockModified",
          "inputs": [
            {
              "name": "prevTimeLock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "newTimeLock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "RegistryTimeLockModified",
          "inputs": [
            {
              "name": "newTimeLock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "prevTimeLock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "GovChangeStarted",
          "inputs": [
            {
              "name": "prevGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "newGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "GovChangeConfirmed",
          "inputs": [
            {
              "name": "prevGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "newGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "GovChangeCancelled",
          "inputs": [
            {
              "name": "cancelledGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "GovRelinquished",
          "inputs": [
            {
              "name": "prevGov",
              "type": "address",
              "indexed": true
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "UndyHqSetupFinished",
          "inputs": [
            {
              "name": "prevGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "newGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "timeLock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "DepartmentPauseModified",
          "inputs": [
            {
              "name": "isPaused",
              "type": "bool",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "DepartmentFundsRecovered",
          "inputs": [
            {
              "name": "asset",
              "type": "address",
              "indexed": true
            },
            {
              "name": "recipient",
              "type": "address",
              "indexed": true
            },
            {
              "name": "balance",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "NewAddressPending",
          "inputs": [
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "NewAddressConfirmed",
          "inputs": [
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "NewAddressCancelled",
          "inputs": [
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressUpdatePending",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "newAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "prevAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "version",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressUpdateConfirmed",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "newAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "prevAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "version",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressUpdateCancelled",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "newAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "prevAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressDisablePending",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "version",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressDisableConfirmed",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "version",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressDisableCancelled",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUndyHqFromGov",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "canGovern",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getGovernors",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address[]"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "hasPendingGovChange",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "startGovernanceChange",
          "inputs": [
            {
              "name": "_newGov",
              "type": "address"
            }
          ],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "confirmGovernanceChange",
          "inputs": [],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "cancelGovernanceChange",
          "inputs": [],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "relinquishGov",
          "inputs": [],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "setGovTimeLock",
          "inputs": [
            {
              "name": "_numBlocks",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidGovTimeLock",
          "inputs": [
            {
              "name": "_newTimeLock",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "minGovChangeTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "maxGovChangeTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "finishUndyHqSetup",
          "inputs": [
            {
              "name": "_newGov",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "finishUndyHqSetup",
          "inputs": [
            {
              "name": "_newGov",
              "type": "address"
            },
            {
              "name": "_timeLock",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "governance",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "pendingGov",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "newGov",
                  "type": "address"
                },
                {
                  "name": "initiatedBlock",
                  "type": "uint256"
                },
                {
                  "name": "confirmBlock",
                  "type": "uint256"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "numGovChanges",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "govChangeTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRegistryDescription",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidNewAddress",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidAddressUpdate",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            },
            {
              "name": "_newAddr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidAddressDisable",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "setRegistryTimeLock",
          "inputs": [
            {
              "name": "_numBlocks",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidRegistryTimeLock",
          "inputs": [
            {
              "name": "_numBlocks",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "setRegistryTimeLockAfterSetup",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "setRegistryTimeLockAfterSetup",
          "inputs": [
            {
              "name": "_numBlocks",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "minRegistryTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "maxRegistryTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidAddr",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidRegId",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRegId",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddr",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddrInfo",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "addr",
                  "type": "address"
                },
                {
                  "name": "version",
                  "type": "uint256"
                },
                {
                  "name": "lastModified",
                  "type": "uint256"
                },
                {
                  "name": "description",
                  "type": "string"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddrDescription",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getNumAddrs",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getLastAddr",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getLastRegId",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "registryChangeTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "addrInfo",
          "inputs": [
            {
              "name": "arg0",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "addr",
                  "type": "address"
                },
                {
                  "name": "version",
                  "type": "uint256"
                },
                {
                  "name": "lastModified",
                  "type": "uint256"
                },
                {
                  "name": "description",
                  "type": "string"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "addrToRegId",
          "inputs": [
            {
              "name": "arg0",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "numAddrs",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "pendingNewAddr",
          "inputs": [
            {
              "name": "arg0",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "description",
                  "type": "string"
                },
                {
                  "name": "initiatedBlock",
                  "type": "uint256"
                },
                {
                  "name": "confirmBlock",
                  "type": "uint256"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "pendingAddrUpdate",
          "inputs": [
            {
              "name": "arg0",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "newAddr",
                  "type": "address"
                },
                {
                  "name": "initiatedBlock",
                  "type": "uint256"
                },
                {
                  "name": "confirmBlock",
                  "type": "uint256"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "pendingAddrDisable",
          "inputs": [
            {
              "name": "arg0",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "initiatedBlock",
                  "type": "uint256"
                },
                {
                  "name": "confirmBlock",
                  "type": "uint256"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddys",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "hq",
                  "type": "address"
                },
                {
                  "name": "undyToken",
                  "type": "address"
                },
                {
                  "name": "ledger",
                  "type": "address"
                },
                {
                  "name": "missionControl",
                  "type": "address"
                },
                {
                  "name": "legoBook",
                  "type": "address"
                },
                {
                  "name": "switchboard",
                  "type": "address"
                },
                {
                  "name": "hatchery",
                  "type": "address"
                },
                {
                  "name": "lootDistributor",
                  "type": "address"
                },
                {
                  "name": "appraiser",
                  "type": "address"
                },
                {
                  "name": "walletBackpack",
                  "type": "address"
                },
                {
                  "name": "billing",
                  "type": "address"
                },
                {
                  "name": "vaultRegistry",
                  "type": "address"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUndyHq",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "canMintUndy",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "pause",
          "inputs": [
            {
              "name": "_shouldPause",
              "type": "bool"
            }
          ],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "recoverFunds",
          "inputs": [
            {
              "name": "_recipient",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            }
          ],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "recoverFundsMany",
          "inputs": [
            {
              "name": "_recipient",
              "type": "address"
            },
            {
              "name": "_assets",
              "type": "address[]"
            }
          ],
          "outputs": []
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isPaused",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isLegoAddr",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "startAddNewAddressToRegistry",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            },
            {
              "name": "_description",
              "type": "string"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "confirmNewAddressToRegistry",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "cancelNewAddressToRegistry",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "startAddressUpdateToRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            },
            {
              "name": "_newAddr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "confirmAddressUpdateToRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "cancelAddressUpdateToRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "startAddressDisableInRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "confirmAddressDisableInRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "cancelAddressDisableInRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "constructor",
          "inputs": [
            {
              "name": "_undyHq",
              "type": "address"
            },
            {
              "name": "_initialGov",
              "type": "address"
            },
            {
              "name": "_minRegistryTimeLock",
              "type": "uint256"
            },
            {
              "name": "_maxRegistryTimeLock",
              "type": "uint256"
            }
          ],
          "outputs": []
        }
      ],
      "solc_json": {
        "language": "Vyper",
        "sources": {
          "contracts/modules/LocalGov.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\ninterface UndyHq:\n    def minGovChangeTimeLock() -> uint256: view\n    def maxGovChangeTimeLock() -> uint256: view\n    def governance() -> address: view\n\nstruct PendingGovernance:\n    newGov: address\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nevent GovChangeStarted:\n    prevGov: indexed(address)\n    newGov: indexed(address)\n    confirmBlock: uint256\n\nevent GovChangeConfirmed:\n    prevGov: indexed(address)\n    newGov: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nevent GovChangeCancelled:\n    cancelledGov: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nevent GovRelinquished:\n    prevGov: indexed(address)\n\nevent GovChangeTimeLockModified:\n    prevTimeLock: uint256\n    newTimeLock: uint256\n\nevent UndyHqSetupFinished:\n    prevGov: indexed(address)\n    newGov: indexed(address)\n    timeLock: uint256\n\n# governance\ngovernance: public(address)\npendingGov: public(PendingGovernance)\nnumGovChanges: public(uint256)\n\n# time lock\ngovChangeTimeLock: public(uint256)\n\n# config\nUNDY_HQ_FOR_GOV: immutable(address)\nMIN_GOV_TIME_LOCK: immutable(uint256)\nMAX_GOV_TIME_LOCK: immutable(uint256)\n\n\n@deploy\ndef __init__(\n    _undyHq: address,\n    _initialGov: address,\n    _minTimeLock: uint256,\n    _maxTimeLock: uint256,\n    _initialTimeLock: uint256,\n):\n    UNDY_HQ_FOR_GOV = _undyHq\n    self.governance = _initialGov\n\n    # undy hq\n    if _undyHq == empty(address):\n        assert _initialGov != empty(address) # dev: undy hq must have gov\n\n    # local gov (department, other smart contracts)\n    else:\n        hqGov: address = staticcall UndyHq(_undyHq).governance()\n        assert hqGov != empty(address) # dev: undy hq must have gov\n        assert _initialGov != hqGov # dev: undy hq cannot set same gov\n\n    # time locks\n    minTimeLock: uint256 = _minTimeLock\n    maxTimeLock: uint256 = _maxTimeLock\n    if minTimeLock == 0 or maxTimeLock == 0:\n        assert _undyHq != empty(address) # dev: need undy hq if no time locks\n        minTimeLock = staticcall UndyHq(_undyHq).minGovChangeTimeLock()\n        maxTimeLock = staticcall UndyHq(_undyHq).maxGovChangeTimeLock()\n\n    # set min and max time locks\n    assert minTimeLock < maxTimeLock # dev: invalid time lock\n    assert minTimeLock != 0 and maxTimeLock != max_value(uint256) # dev: invalid time lock\n    MIN_GOV_TIME_LOCK = minTimeLock\n    MAX_GOV_TIME_LOCK = maxTimeLock\n\n    # this contract is top level governance from Undy HQ -- not setting initial time lock during setup\n    if _undyHq == empty(address):\n        return\n\n    # set initial time lock (for local gov)\n    initialTimeLock: uint256 = max(minTimeLock, _initialTimeLock)\n    assert self._setGovTimeLock(initialTimeLock) # dev: invalid time lock\n\n\n@view\n@external\ndef getUndyHqFromGov() -> address:\n    return self._getUndyHqFromGov()\n\n\n@view\n@internal\ndef _getUndyHqFromGov() -> address:\n    return UNDY_HQ_FOR_GOV\n\n\n##############\n# Gov Access #\n##############\n\n\n@view\n@external\ndef canGovern(_addr: address) -> bool:\n    return self._canGovern(_addr)\n\n\n@view\n@internal\ndef _canGovern(_addr: address) -> bool:\n    if _addr == empty(address):\n        return False\n    return _addr in self._getGovernors()\n\n\n@view\n@external\ndef getGovernors() -> DynArray[address, 2]:\n    return self._getGovernors()\n\n\n@view\n@internal\ndef _getGovernors() -> DynArray[address, 2]:\n    governors: DynArray[address, 2] = []\n\n    # local governance\n    localGov: address = self.governance\n    if localGov != empty(address):\n        governors.append(localGov)\n\n    # undy hq governance\n    undyHq: address = UNDY_HQ_FOR_GOV\n    if undyHq == empty(address):\n        return governors\n\n    hqGov: address = staticcall UndyHq(undyHq).governance()\n    if hqGov != empty(address):\n        governors.append(hqGov)\n\n    return governors\n\n\n######################\n# Governance Changes #\n######################\n\n\n@view\n@external\ndef hasPendingGovChange() -> bool:\n    return self.pendingGov.confirmBlock != 0\n\n\n@view\n@internal\ndef _isUndyHq() -> bool:\n    return UNDY_HQ_FOR_GOV == empty(address)\n\n\n# start gov change\n\n\n@external\ndef startGovernanceChange(_newGov: address):\n    governors: DynArray[address, 2] = self._getGovernors()\n    assert msg.sender in governors # dev: no perms\n\n    # validation\n    if _newGov != empty(address):\n        assert _newGov not in governors # dev: invalid _newGov\n        assert _newGov.is_contract # dev: _newGov must be a contract\n    else:\n        assert not self._isUndyHq() # dev: undy hq cannot set 0x0\n\n    confirmBlock: uint256 = block.number + self.govChangeTimeLock\n    self.pendingGov = PendingGovernance(\n        newGov= _newGov,\n        initiatedBlock= block.number,\n        confirmBlock= confirmBlock,\n    )\n    log GovChangeStarted(prevGov=self.governance, newGov=_newGov, confirmBlock=confirmBlock)\n\n\n# confirm gov change\n\n\n@external\ndef confirmGovernanceChange():\n    data: PendingGovernance = self.pendingGov\n    assert data.confirmBlock != 0 and block.number >= data.confirmBlock # dev: time lock not reached\n\n    # check permissions\n    if data.newGov != empty(address):\n        assert msg.sender == data.newGov # dev: only new gov can confirm\n    else:\n        assert self._canGovern(msg.sender) # dev: no perms\n        assert not self._isUndyHq() # dev: undy hq cannot set 0x0\n\n    # set new governance\n    prevGov: address = self.governance\n    self.governance = data.newGov\n    self.numGovChanges += 1\n    self.pendingGov = empty(PendingGovernance)\n    log GovChangeConfirmed(prevGov=prevGov, newGov=data.newGov, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock)\n\n\n# cancel gov change\n\n\n@external\ndef cancelGovernanceChange():\n    assert self._canGovern(msg.sender) # dev: no perms\n    data: PendingGovernance = self.pendingGov\n    assert data.confirmBlock != 0 # dev: no pending change\n    self.pendingGov = empty(PendingGovernance)\n    log GovChangeCancelled(cancelledGov=data.newGov, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock)\n\n\n# relinquish gov (only for local gov)\n\n\n@external\ndef relinquishGov():\n    assert msg.sender == self.governance # dev: no perms\n    assert not self._isUndyHq() # dev: undy hq cannot relinquish gov\n\n    self.governance = empty(address)\n    self.numGovChanges += 1\n    log GovRelinquished(prevGov=msg.sender)\n\n\n####################\n# Time Lock Config #\n####################\n\n\n# set time lock\n\n\n@external\ndef setGovTimeLock(_numBlocks: uint256) -> bool:\n    assert self._canGovern(msg.sender) # dev: no perms\n    return self._setGovTimeLock(_numBlocks)\n\n\n@internal\ndef _setGovTimeLock(_numBlocks: uint256) -> bool:\n    prevTimeLock: uint256 = self.govChangeTimeLock\n    assert self._isValidGovTimeLock(_numBlocks, prevTimeLock) # dev: invalid time lock\n    self.govChangeTimeLock = _numBlocks\n    log GovChangeTimeLockModified(prevTimeLock=prevTimeLock, newTimeLock=_numBlocks)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidGovTimeLock(_newTimeLock: uint256) -> bool:\n    return self._isValidGovTimeLock(_newTimeLock, self.govChangeTimeLock)\n\n\n@view\n@internal\ndef _isValidGovTimeLock(_newTimeLock: uint256, _prevTimeLock: uint256) -> bool:\n    if _newTimeLock == _prevTimeLock:\n        return False # no change\n    if self.pendingGov.confirmBlock != 0:\n        return False # cannot change while pending gov change\n    return _newTimeLock >= MIN_GOV_TIME_LOCK and _newTimeLock <= MAX_GOV_TIME_LOCK\n\n\n# utils\n\n\n@view\n@external\ndef minGovChangeTimeLock() -> uint256:\n    return MIN_GOV_TIME_LOCK\n\n\n@view\n@external\ndef maxGovChangeTimeLock() -> uint256:\n    return MAX_GOV_TIME_LOCK\n\n\n#################\n# Undy Hq Setup #\n#################\n\n\n@external\ndef finishUndyHqSetup(_newGov: address, _timeLock: uint256 = 0) -> bool:\n    assert self._isUndyHq() # dev: only undy hq\n    assert msg.sender == self.governance # dev: no perms\n    assert self.numGovChanges == 0 # dev: already changed gov\n\n    # validation\n    assert _newGov != empty(address) and _newGov.is_contract # dev: invalid _newGov\n    prevGov: address = self.governance\n\n    # set new gov\n    self.governance = _newGov\n    self.numGovChanges += 1\n\n    # set time lock\n    timeLock: uint256 = _timeLock\n    if timeLock == 0:\n        timeLock = MIN_GOV_TIME_LOCK\n    assert self._setGovTimeLock(timeLock) # dev: invalid time lock\n\n    log UndyHqSetupFinished(prevGov=prevGov, newGov=_newGov, timeLock=timeLock)\n    return True",
            "sha256sum": "c41aa3e0d0d96b512171813377ea277e2c7da690c3cd9b4662733b3f11f705b0"
          },
          "contracts/modules/AddressRegistry.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\nuses: gov\nimport contracts.modules.LocalGov as gov\n\nstruct AddressInfo:\n    addr: address\n    version: uint256\n    lastModified: uint256\n    description: String[64]\n\nstruct PendingNewAddress:\n    description: String[64]\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nstruct PendingAddressUpdate:\n    newAddr: address\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nstruct PendingAddressDisable:\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nevent NewAddressPending:\n    addr: indexed(address)\n    description: String[64]\n    confirmBlock: uint256\n    registry: String[28]\n\nevent NewAddressConfirmed:\n    addr: indexed(address)\n    regId: uint256\n    description: String[64]\n    registry: String[28]\n\nevent NewAddressCancelled:\n    description: String[64]\n    addr: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent AddressUpdatePending:\n    regId: uint256\n    description: String[64]\n    newAddr: indexed(address)\n    prevAddr: indexed(address)\n    version: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent AddressUpdateConfirmed:\n    regId: uint256\n    description: String[64]\n    newAddr: indexed(address)\n    prevAddr: indexed(address)\n    version: uint256\n    registry: String[28]\n\nevent AddressUpdateCancelled:\n    regId: uint256\n    description: String[64]\n    newAddr: indexed(address)\n    prevAddr: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent AddressDisablePending:\n    regId: uint256\n    description: String[64]\n    addr: indexed(address)\n    version: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent AddressDisableConfirmed:\n    regId: uint256\n    description: String[64]\n    addr: indexed(address)\n    version: uint256\n    registry: String[28]\n\nevent AddressDisableCancelled:\n    regId: uint256\n    description: String[64]\n    addr: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent RegistryTimeLockModified:\n    newTimeLock: uint256\n    prevTimeLock: uint256\n    registry: String[28]\n\n# time lock\nregistryChangeTimeLock: public(uint256)\n\n# core data (address registry)\naddrInfo: public(HashMap[uint256, AddressInfo]) # regId -> address info\naddrToRegId: public(HashMap[address, uint256]) # addr -> regId\nnumAddrs: public(uint256) # number of addrs in registry\n\n# pending changes\npendingNewAddr: public(HashMap[address, PendingNewAddress]) # addr -> pending new addr\npendingAddrUpdate: public(HashMap[uint256, PendingAddressUpdate]) # regId -> pending addr update\npendingAddrDisable: public(HashMap[uint256, PendingAddressDisable]) # regId -> pending addr disable\n\nREGISTRY_STR: immutable(String[28])\nMIN_REG_TIME_LOCK: immutable(uint256)\nMAX_REG_TIME_LOCK: immutable(uint256)\n\n\n@deploy\ndef __init__(\n    _minTimeLock: uint256,\n    _maxTimeLock: uint256,\n    _initialTimeLock: uint256,\n    _registryStr: String[28],\n):\n    REGISTRY_STR = _registryStr\n\n    assert _minTimeLock < _maxTimeLock # dev: invalid time lock\n    assert _minTimeLock != 0 and _maxTimeLock != max_value(uint256) # dev: invalid time lock\n    MIN_REG_TIME_LOCK = _minTimeLock\n    MAX_REG_TIME_LOCK = _maxTimeLock\n\n    # set initial time lock -- this may be zero during inital setup of registry\n    if _initialTimeLock != 0:\n        assert self._setRegistryTimeLock(_initialTimeLock) # dev: invalid time lock\n\n    # start at 1 index\n    self.numAddrs = 1\n\n\n@view\n@external\ndef getRegistryDescription() -> String[28]:\n    return REGISTRY_STR\n\n\n###############\n# New Address #\n###############\n\n\n# register new address\n\n\n@internal\ndef _startAddNewAddressToRegistry(_addr: address, _description: String[64]) -> bool:\n    assert self._isValidNewAddress(_addr) # dev: invalid addy\n\n    confirmBlock: uint256 = block.number + self.registryChangeTimeLock\n    self.pendingNewAddr[_addr] = PendingNewAddress(\n        description=_description,\n        initiatedBlock=block.number,\n        confirmBlock=confirmBlock,\n    )\n\n    log NewAddressPending(addr=_addr, description=_description, confirmBlock=confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# confirm new address\n\n\n@internal\ndef _confirmNewAddressToRegistry(_addr: address) -> uint256:\n    data: PendingNewAddress = self.pendingNewAddr[_addr]\n    assert data.confirmBlock != 0 and block.number >= data.confirmBlock # dev: time lock not reached\n\n    if not self._isValidNewAddress(_addr):\n        self.pendingNewAddr[_addr] = empty(PendingNewAddress) # clear pending\n        return 0\n\n    # register new addy\n    regId: uint256 = self.numAddrs\n    self.addrToRegId[_addr] = regId\n    self.numAddrs = regId + 1\n    self.addrInfo[regId] = AddressInfo(\n        addr=_addr,\n        version=1,\n        lastModified=block.timestamp,\n        description=data.description,\n    )\n\n    # clear pending\n    self.pendingNewAddr[_addr] = empty(PendingNewAddress)\n\n    log NewAddressConfirmed(addr=_addr, regId=regId, description=data.description, registry=REGISTRY_STR)\n    return regId\n\n\n# cancel new address\n\n\n@internal\ndef _cancelNewAddressToRegistry(_addr: address) -> bool:\n    data: PendingNewAddress = self.pendingNewAddr[_addr]\n    assert data.confirmBlock != 0 # dev: no pending\n\n    self.pendingNewAddr[_addr] = empty(PendingNewAddress)\n    log NewAddressCancelled(description=data.description, addr=_addr, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidNewAddress(_addr: address) -> bool:\n    return self._isValidNewAddress(_addr)\n\n\n@view\n@internal\ndef _isValidNewAddress(_addr: address) -> bool:\n    if _addr == empty(address) or not _addr.is_contract:\n        return False\n    return self.addrToRegId[_addr] == 0\n\n\n###################\n# Address Updates #\n###################\n\n\n# update address\n\n\n@internal\ndef _startAddressUpdateToRegistry(_regId: uint256, _newAddr: address) -> bool:\n    data: AddressInfo = self.addrInfo[_regId]\n    assert self._isValidAddressUpdate(_regId, _newAddr, data.addr) # dev: invalid update\n\n    # set pending\n    confirmBlock: uint256 = block.number + self.registryChangeTimeLock\n    self.pendingAddrUpdate[_regId] = PendingAddressUpdate(\n        newAddr=_newAddr,\n        initiatedBlock=block.number,\n        confirmBlock=confirmBlock,\n    )\n\n    log AddressUpdatePending(regId=_regId, description=data.description, newAddr=_newAddr, prevAddr=data.addr, version=data.version, confirmBlock=confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# confirm update address\n\n\n@internal\ndef _confirmAddressUpdateToRegistry(_regId: uint256) -> bool:\n    newData: PendingAddressUpdate = self.pendingAddrUpdate[_regId]\n    assert newData.confirmBlock != 0 and block.number >= newData.confirmBlock # dev: time lock not reached\n\n    data: AddressInfo = self.addrInfo[_regId]\n    prevAddr: address = data.addr # needed for later\n    if not self._isValidAddressUpdate(_regId, newData.newAddr, prevAddr):\n        self.pendingAddrUpdate[_regId] = empty(PendingAddressUpdate) # clear pending\n        return False\n\n    # update addy data\n    data.addr = newData.newAddr\n    data.lastModified = block.timestamp\n    data.version += 1\n    self.addrInfo[_regId] = data\n    self.addrToRegId[newData.newAddr] = _regId\n\n    # handle previous addr\n    if prevAddr != empty(address):\n        self.addrToRegId[prevAddr] = 0\n\n    # clear pending\n    self.pendingAddrUpdate[_regId] = empty(PendingAddressUpdate)\n\n    log AddressUpdateConfirmed(regId=_regId, description=data.description, newAddr=newData.newAddr, prevAddr=prevAddr, version=data.version, registry=REGISTRY_STR)\n    return True\n\n\n# cancel update address\n\n\n@internal\ndef _cancelAddressUpdateToRegistry(_regId: uint256) -> bool:\n    data: PendingAddressUpdate = self.pendingAddrUpdate[_regId]\n    assert data.confirmBlock != 0 # dev: no pending\n\n    self.pendingAddrUpdate[_regId] = empty(PendingAddressUpdate)\n    prevData: AddressInfo = self.addrInfo[_regId]\n    log AddressUpdateCancelled(regId=_regId, description=prevData.description, newAddr=data.newAddr, prevAddr=prevData.addr, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidAddressUpdate(_regId: uint256, _newAddr: address) -> bool:\n    return self._isValidAddressUpdate(_regId, _newAddr, self.addrInfo[_regId].addr)\n\n\n@view\n@internal\ndef _isValidAddressUpdate(_regId: uint256, _newAddr: address, _prevAddr: address) -> bool:\n    if not self._isValidRegId(_regId):\n        return False\n    if not self._isValidNewAddress(_newAddr):\n        return False\n    return _newAddr != _prevAddr\n\n\n###################\n# Disable Address #\n###################\n\n\n# start disable address\n\n\n@internal\ndef _startAddressDisableInRegistry(_regId: uint256) -> bool:\n    data: AddressInfo = self.addrInfo[_regId]\n    assert self._isValidAddressDisable(_regId, data.addr) # dev: invalid disable\n\n    # set pending\n    confirmBlock: uint256 = block.number + self.registryChangeTimeLock\n    self.pendingAddrDisable[_regId] = PendingAddressDisable(\n        initiatedBlock=block.number,\n        confirmBlock=confirmBlock,\n    )\n\n    log AddressDisablePending(regId=_regId, description=data.description, addr=data.addr, version=data.version, confirmBlock=confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# confirm disable address\n\n\n@internal\ndef _confirmAddressDisableInRegistry(_regId: uint256) -> bool:\n    newData: PendingAddressDisable = self.pendingAddrDisable[_regId]\n    assert newData.confirmBlock != 0 and block.number >= newData.confirmBlock # dev: time lock not reached\n\n    data: AddressInfo = self.addrInfo[_regId]\n    prevAddr: address = data.addr # needed for later\n    if not self._isValidAddressDisable(_regId, prevAddr):\n        self.pendingAddrDisable[_regId] = empty(PendingAddressDisable) # clear pending\n        return False\n\n    # disable addy\n    data.addr = empty(address)\n    data.lastModified = block.timestamp\n    data.version += 1\n    self.addrInfo[_regId] = data\n    self.addrToRegId[prevAddr] = 0\n\n    # clear pending\n    self.pendingAddrDisable[_regId] = empty(PendingAddressDisable)\n\n    log AddressDisableConfirmed(regId=_regId, description=data.description, addr=prevAddr, version=data.version, registry=REGISTRY_STR)\n    return True\n\n\n# cancel disable address\n\n\n@internal\ndef _cancelAddressDisableInRegistry(_regId: uint256) -> bool:\n    data: PendingAddressDisable = self.pendingAddrDisable[_regId]\n    assert data.confirmBlock != 0 # dev: no pending\n\n    self.pendingAddrDisable[_regId] = empty(PendingAddressDisable)\n    prevData: AddressInfo = self.addrInfo[_regId]\n    log AddressDisableCancelled(regId=_regId, description=prevData.description, addr=prevData.addr, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidAddressDisable(_regId: uint256) -> bool:\n    return self._isValidAddressDisable(_regId, self.addrInfo[_regId].addr)\n\n\n@view\n@internal\ndef _isValidAddressDisable(_regId: uint256, _prevAddr: address) -> bool:\n    if not self._isValidRegId(_regId):\n        return False\n    return _prevAddr != empty(address)\n\n\n####################\n# Time Lock Config #\n####################\n\n\n@external\ndef setRegistryTimeLock(_numBlocks: uint256) -> bool:\n    assert gov._canGovern(msg.sender) # dev: no perms\n    return self._setRegistryTimeLock(_numBlocks)\n\n\n@internal\ndef _setRegistryTimeLock(_numBlocks: uint256) -> bool:\n    prevTimeLock: uint256 = self.registryChangeTimeLock\n    assert self._isValidRegistryTimeLock(_numBlocks, prevTimeLock) # dev: invalid time lock\n    self.registryChangeTimeLock = _numBlocks\n    log RegistryTimeLockModified(newTimeLock=_numBlocks, prevTimeLock=prevTimeLock, registry=REGISTRY_STR)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidRegistryTimeLock(_numBlocks: uint256) -> bool:\n    return self._isValidRegistryTimeLock(_numBlocks, self.registryChangeTimeLock)\n\n\n@view\n@internal\ndef _isValidRegistryTimeLock(_newTimeLock: uint256, _prevTimeLock: uint256) -> bool:\n    if _newTimeLock == _prevTimeLock:\n        return False\n    return _newTimeLock >= MIN_REG_TIME_LOCK and _newTimeLock <= MAX_REG_TIME_LOCK\n\n\n# finish setup\n\n\n@external\ndef setRegistryTimeLockAfterSetup(_numBlocks: uint256 = 0) -> bool:\n    assert gov._canGovern(msg.sender) # dev: no perms\n    assert self.registryChangeTimeLock == 0 # dev: already set\n\n    timeLock: uint256 = _numBlocks\n    if timeLock == 0:\n        timeLock = MIN_REG_TIME_LOCK\n    return self._setRegistryTimeLock(timeLock)\n\n\n# utils\n\n\n@view\n@external\ndef minRegistryTimeLock() -> uint256:\n    return MIN_REG_TIME_LOCK\n\n\n@view\n@external\ndef maxRegistryTimeLock() -> uint256:\n    return MAX_REG_TIME_LOCK\n\n\n#################\n# Views / Utils #\n#################\n\n\n# is valid addr\n\n\n@view\n@external\ndef isValidAddr(_addr: address) -> bool:\n    return self._isValidAddr(_addr)\n\n\n@view\n@internal\ndef _isValidAddr(_addr: address) -> bool:\n    return self.addrToRegId[_addr] != 0\n\n\n# is valid addr id\n\n\n@view\n@external\ndef isValidRegId(_regId: uint256) -> bool:\n    return self._isValidRegId(_regId)\n\n\n@view\n@internal\ndef _isValidRegId(_regId: uint256) -> bool:\n    return _regId != 0 and _regId < self.numAddrs\n\n\n# get reg id\n\n\n@view\n@external\ndef getRegId(_addr: address) -> uint256:\n    return self._getRegId(_addr)\n\n\n@view\n@internal\ndef _getRegId(_addr: address) -> uint256:\n    return self.addrToRegId[_addr]\n\n\n# get addr\n\n\n@view\n@external\ndef getAddr(_regId: uint256) -> address:\n    return self._getAddr(_regId)\n\n\n@view\n@internal\ndef _getAddr(_regId: uint256) -> address:\n    return self.addrInfo[_regId].addr\n\n\n# get addr info\n\n\n@view\n@external\ndef getAddrInfo(_regId: uint256) -> AddressInfo:\n    return self._getAddrInfo(_regId)\n\n\n@view\n@internal\ndef _getAddrInfo(_regId: uint256) -> AddressInfo:\n    return self.addrInfo[_regId]\n\n\n# get addr description\n\n\n@view\n@external\ndef getAddrDescription(_regId: uint256) -> String[64]:\n    return self._getAddrDescription(_regId)\n\n\n@view\n@internal\ndef _getAddrDescription(_regId: uint256) -> String[64]:\n    return self.addrInfo[_regId].description\n\n\n# get num addrs\n\n\n@view\n@external\ndef getNumAddrs() -> uint256:\n    return self._getNumAddrs()\n\n\n@view\n@internal\ndef _getNumAddrs() -> uint256:\n    return self.numAddrs - 1\n\n\n# get last addr\n\n\n@view\n@external\ndef getLastAddr() -> address:\n    return self._getLastAddr()\n\n\n@view\n@internal\ndef _getLastAddr() -> address:\n    lastRegId: uint256 = self.numAddrs - 1\n    return self.addrInfo[lastRegId].addr\n\n\n# get last reg id\n\n\n@view\n@external\ndef getLastRegId() -> uint256:\n    return self._getLastRegId()\n\n\n@view\n@internal\ndef _getLastRegId() -> uint256:\n    return self.numAddrs - 1\n",
            "sha256sum": "b88f6fc85ae3cd815c5a476c620b2fb5494b4dec5f1ce738878eded11c46396b"
          },
          "contracts/modules/Addys.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\ninterface UndyHq:\n    def isValidAddr(_addr: address) -> bool: view\n    def getAddr(_regId: uint256) -> address: view\n    def undyToken() -> address: view\n\ninterface Switchboard:\n    def isSwitchboardAddr(_addr: address) -> bool: view\n\ninterface LegoBook:\n    def isLegoAddr(_addr: address) -> bool: view\n\nstruct Addys:\n    hq: address\n    undyToken: address\n    ledger: address\n    missionControl: address\n    legoBook: address\n    switchboard: address\n    hatchery: address\n    lootDistributor: address\n    appraiser: address\n    walletBackpack: address\n    billing: address\n    vaultRegistry: address\n\n# hq\nUNDY_HQ_FOR_ADDYS: immutable(address)\n\n# core addys\nLEDGER_ID: constant(uint256) = 1\nMISSION_CONTROL_ID: constant(uint256) = 2\nLEGO_BOOK_ID: constant(uint256) = 3\nSWITCHBOARD_ID: constant(uint256) = 4\nHATCHERY_ID: constant(uint256) = 5\nLOOT_DISTRIBUTOR_ID: constant(uint256) = 6\nAPPRAISER_ID: constant(uint256) = 7\nWALLET_BACKPACK_ID: constant(uint256) = 8\nBILLING_ID: constant(uint256) = 9\nVAULT_REGISTRY_ID: constant(uint256) = 10\nHELPERS_ID: constant(uint256) = 11\n\n\n@deploy\ndef __init__(_undyHq: address):\n    assert _undyHq != empty(address) # dev: invalid undy hq\n    UNDY_HQ_FOR_ADDYS = _undyHq\n\n\n########\n# Core #\n########\n\n\n@view\n@external\ndef getAddys() -> Addys:\n    return self._generateAddys()\n\n\n@view\n@internal\ndef _getAddys(_addys: Addys = empty(Addys)) -> Addys:\n    if _addys.hq != empty(address):\n        return _addys\n    return self._generateAddys()\n\n\n@view\n@internal\ndef _generateAddys() -> Addys:\n    hq: address = UNDY_HQ_FOR_ADDYS\n    return Addys(\n        hq = hq,\n        undyToken = staticcall UndyHq(hq).undyToken(),\n        ledger = staticcall UndyHq(hq).getAddr(LEDGER_ID),\n        missionControl = staticcall UndyHq(hq).getAddr(MISSION_CONTROL_ID),\n        legoBook = staticcall UndyHq(hq).getAddr(LEGO_BOOK_ID),\n        switchboard = staticcall UndyHq(hq).getAddr(SWITCHBOARD_ID),\n        hatchery = staticcall UndyHq(hq).getAddr(HATCHERY_ID),\n        lootDistributor = staticcall UndyHq(hq).getAddr(LOOT_DISTRIBUTOR_ID),\n        appraiser = staticcall UndyHq(hq).getAddr(APPRAISER_ID),\n        walletBackpack = staticcall UndyHq(hq).getAddr(WALLET_BACKPACK_ID),\n        billing = staticcall UndyHq(hq).getAddr(BILLING_ID),\n        vaultRegistry = staticcall UndyHq(hq).getAddr(VAULT_REGISTRY_ID),\n    )\n\n\n##########\n# Tokens #\n##########\n\n\n@view\n@internal\ndef _getUndyToken() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).undyToken()\n\n\n###########\n# Helpers #\n###########\n\n\n# undy hq\n\n\n@view\n@external\ndef getUndyHq() -> address:\n    return self._getUndyHq()\n\n\n@view\n@internal\ndef _getUndyHq() -> address:\n    return UNDY_HQ_FOR_ADDYS\n\n\n# utils\n\n\n@view\n@internal\ndef _isValidUndyAddr(_addr: address, _hq: address = empty(address)) -> bool:\n    hq: address = _hq\n    if _hq == empty(address):\n        hq = UNDY_HQ_FOR_ADDYS\n    \n    # core departments\n    if staticcall UndyHq(hq).isValidAddr(_addr):\n        return True\n\n    # lego book\n    legoBook: address = staticcall UndyHq(hq).getAddr(LEGO_BOOK_ID)\n    if legoBook != empty(address) and staticcall LegoBook(legoBook).isLegoAddr(_addr):\n        return True\n\n    # switchboard config\n    switchboard: address = staticcall UndyHq(hq).getAddr(SWITCHBOARD_ID)\n    if switchboard != empty(address) and staticcall Switchboard(switchboard).isSwitchboardAddr(_addr):\n        return True\n\n    return False\n\n\n@view\n@internal\ndef _isSwitchboardAddr(_addr: address) -> bool:\n    switchboard: address = staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(SWITCHBOARD_ID)\n    if switchboard == empty(address):\n        return False\n    return staticcall Switchboard(switchboard).isSwitchboardAddr(_addr)\n\n\n@view\n@internal\ndef _isLegoBookAddr(_addr: address) -> bool:\n    legoBook: address = staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEGO_BOOK_ID)\n    if legoBook == empty(address):\n        return False\n    return staticcall LegoBook(legoBook).isLegoAddr(_addr)\n\n\n###############\n# Departments #\n###############\n\n\n# ledger\n\n\n@view\n@internal\ndef _getLedgerId() -> uint256:\n    return LEDGER_ID\n\n\n@view\n@internal\ndef _getLedgerAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEDGER_ID)\n\n\n# mission control\n\n\n@view\n@internal\ndef _getMissionControlId() -> uint256:\n    return MISSION_CONTROL_ID\n\n\n@view\n@internal\ndef _getMissionControlAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(MISSION_CONTROL_ID)\n\n\n# lego book\n\n\n@view\n@internal\ndef _getLegoBookId() -> uint256:\n    return LEGO_BOOK_ID\n\n\n@view\n@internal\ndef _getLegoBookAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEGO_BOOK_ID)\n\n\n# switchboard\n\n\n@view\n@internal\ndef _getSwitchboardId() -> uint256:\n    return SWITCHBOARD_ID\n\n\n@view\n@internal\ndef _getSwitchboardAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(SWITCHBOARD_ID)\n\n\n# hatchery\n\n\n@view\n@internal\ndef _getHatcheryId() -> uint256:\n    return HATCHERY_ID\n\n\n@view\n@internal\ndef _getHatcheryAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(HATCHERY_ID)\n\n\n# loot distributor\n\n\n@view\n@internal\ndef _getLootDistributorId() -> uint256:\n    return LOOT_DISTRIBUTOR_ID\n\n\n@view\n@internal\ndef _getLootDistributorAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LOOT_DISTRIBUTOR_ID)\n\n\n# appraiser\n\n\n@view\n@internal\ndef _getAppraiserId() -> uint256:\n    return APPRAISER_ID\n\n\n@view\n@internal\ndef _getAppraiserAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(APPRAISER_ID)\n\n\n# wallet backpack\n\n\n@view\n@internal\ndef _getWalletBackpackId() -> uint256:\n    return WALLET_BACKPACK_ID\n\n\n@view\n@internal\ndef _getWalletBackpackAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(WALLET_BACKPACK_ID)\n\n\n# billing\n\n\n@view\n@internal\ndef _getBillingId() -> uint256:\n    return BILLING_ID\n\n\n@view\n@internal\ndef _getBillingAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(BILLING_ID)\n\n\n# vault registry\n\n\n@view\n@internal\ndef _getVaultRegistryId() -> uint256:\n    return VAULT_REGISTRY_ID\n\n\n@view\n@internal\ndef _getVaultRegistryAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(VAULT_REGISTRY_ID)\n\n\n# helpers\n\n\n@view\n@internal\ndef _getHelpersId() -> uint256:\n    return HELPERS_ID\n\n\n@view\n@internal\ndef _getHelpersAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(HELPERS_ID)",
            "sha256sum": "f550bb73a39fbf28fbeb23943f6c870a2f9a4263ded93b50950ed42ea0346155"
          },
          "interfaces/Department.vyi": {
            "content": "# @version 0.4.3\n\n\n###########\n# Minting #\n###########\n\n\n@view\n@external\ndef canMintUndy() -> bool:\n    # used in UndyHq.vy\n    ...\n\n\n########\n# Undy #\n########\n\n\n@view\n@external\ndef isPaused() -> bool:\n    ...\n\n\n@external\ndef pause(_shouldPause: bool):\n    ...\n\n\n@external\ndef recoverFunds(_recipient: address, _asset: address):\n    ...\n\n@external\ndef recoverFundsMany(_recipient: address, _assets: DynArray[address, 20]):\n    ...",
            "sha256sum": "53e48da591c4ee36045a8950c9d3a01458456b471b797df536e9a9f54404e721"
          },
          "contracts/modules/DeptBasics.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\nuses: addys\nimplements: dept\n\nimport contracts.modules.Addys as addys\nimport interfaces.Department as dept\nfrom ethereum.ercs import IERC20\n\nevent DepartmentPauseModified:\n    isPaused: bool\n\nevent DepartmentFundsRecovered:\n    asset: indexed(address)\n    recipient: indexed(address)\n    balance: uint256\n\nisPaused: public(bool)\n\nCAN_MINT_UNDY: immutable(bool)\nMAX_RECOVER_ASSETS: constant(uint256) = 20\n\n\n@deploy\ndef __init__(_shouldPause: bool, _canMintUndy: bool):\n    self.isPaused = _shouldPause\n    CAN_MINT_UNDY = _canMintUndy\n\n\n###########\n# Minting #\n###########\n\n\n@view\n@external\ndef canMintUndy() -> bool:\n    return CAN_MINT_UNDY\n\n\n########\n# Undy #\n########\n\n\n# activate\n\n\n@external\ndef pause(_shouldPause: bool):\n    assert addys._isSwitchboardAddr(msg.sender) # dev: no perms\n    assert _shouldPause != self.isPaused # dev: no change\n    self.isPaused = _shouldPause\n    log DepartmentPauseModified(isPaused=_shouldPause)\n\n\n# recover funds\n\n\n@external\ndef recoverFunds(_recipient: address, _asset: address):\n    assert addys._isSwitchboardAddr(msg.sender) # dev: no perms\n    self._recoverFunds(_recipient, _asset)\n\n\n@external\ndef recoverFundsMany(_recipient: address, _assets: DynArray[address, MAX_RECOVER_ASSETS]):\n    assert addys._isSwitchboardAddr(msg.sender) # dev: no perms\n    for a: address in _assets:\n        self._recoverFunds(_recipient, a)\n\n\n@internal\ndef _recoverFunds(_recipient: address, _asset: address):\n    assert empty(address) not in [_recipient, _asset] # dev: invalid recipient or asset\n    balance: uint256 = staticcall IERC20(_asset).balanceOf(self)\n    assert balance != 0 # dev: nothing to recover\n\n    assert extcall IERC20(_asset).transfer(_recipient, balance, default_return_value=True) # dev: recovery failed\n    log DepartmentFundsRecovered(asset=_asset, recipient=_recipient, balance=balance)\n",
            "sha256sum": "976a50a3807bcf71f3f1c57de5cd7a59fe4e8f27b4d4560e774073962f44d1ac"
          },
          "interfaces/WalletStructs.vyi": {
            "content": "# @version 0.4.3\n\nflag ActionType:\n    TRANSFER\n    EARN_DEPOSIT\n    EARN_WITHDRAW\n    EARN_REBALANCE\n    SWAP\n    MINT_REDEEM\n    CONFIRM_MINT_REDEEM\n    ADD_COLLATERAL\n    REMOVE_COLLATERAL\n    BORROW\n    REPAY_DEBT\n    REWARDS\n    ETH_TO_WETH\n    WETH_TO_ETH\n    ADD_LIQ\n    REMOVE_LIQ\n    ADD_LIQ_CONC\n    REMOVE_LIQ_CONC\n    PAY_CHEQUE\n\nstruct WalletAssetData:\n    assetBalance: uint256\n    usdValue: uint256\n    isYieldAsset: bool\n    lastPricePerShare: uint256\n\nstruct ActionData:\n    ledger: address\n    missionControl: address\n    legoBook: address\n    hatchery: address\n    lootDistributor: address\n    appraiser: address\n    billing: address\n    vaultRegistry: address\n    wallet: address\n    walletConfig: address\n    walletOwner: address\n    inEjectMode: bool\n    isFrozen: bool\n    lastTotalUsdValue: uint256\n    signer: address\n    isManager: bool\n    legoId: uint256\n    legoAddr: address\n    eth: address\n    weth: address\n\nstruct MiniAddys:\n    ledger: address\n    missionControl: address\n    legoBook: address\n    appraiser: address",
            "sha256sum": "466493c129135c95470aaf70eeddc936632f7b0f813396e5a7ddc03bea9da518"
          },
          "interfaces/LegoPartner.vyi": {
            "content": "# @version 0.4.3\n\nfrom interfaces import WalletStructs as ws\n\nMAX_TOKEN_PATH: constant(uint256) = 5\nMAX_RECOVER_ASSETS: constant(uint256) = 20\nMAX_PROOFS: constant(uint256) = 25\n\n@external\ndef addLiquidityConcentrated(_nftTokenId: uint256, _pool: address, _tokenA: address, _tokenB: address, _tickLower: int24, _tickUpper: int24, _amountA: uint256, _amountB: uint256, _minAmountA: uint256, _minAmountB: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256, uint256, uint256, uint256):\n    ...\n\n@external\ndef addLiquidity(_pool: address, _tokenA: address, _tokenB: address, _amountA: uint256, _amountB: uint256, _minAmountA: uint256, _minAmountB: uint256, _minLpAmount: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (address, uint256, uint256, uint256, uint256):\n    ...\n\n@external\ndef removeLiquidityConcentrated(_nftTokenId: uint256, _pool: address, _tokenA: address, _tokenB: address, _liqToRemove: uint256, _minAmountA: uint256, _minAmountB: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256, uint256, bool, uint256):\n    ...\n\n@external\ndef removeLiquidity(_pool: address, _tokenA: address, _tokenB: address, _lpToken: address, _lpAmount: uint256, _minAmountA: uint256, _minAmountB: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256, uint256, uint256):\n    ...\n\n@external\ndef mintOrRedeemAsset(_tokenIn: address, _tokenOut: address, _tokenInAmount: uint256, _minAmountOut: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256, bool, uint256):\n    ...\n\n@external\ndef swapTokens(_amountIn: uint256, _minAmountOut: uint256, _tokenPath: DynArray[address, MAX_TOKEN_PATH], _poolPath: DynArray[address, MAX_TOKEN_PATH - 1], _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256, uint256):\n    ...\n\n@external\ndef depositForYield(_asset: address, _amount: uint256, _vaultAddr: address, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, address, uint256, uint256):\n    ...\n\n@external\ndef withdrawFromYield(_vaultToken: address, _amount: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, address, uint256, uint256):\n    ...\n\n@external\ndef confirmMintOrRedeemAsset(_tokenIn: address, _tokenOut: address, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256):\n    ...\n\n@external\ndef borrow(_borrowAsset: address, _amount: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256):\n    ...\n\n@external\ndef repayDebt(_paymentAsset: address, _paymentAmount: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256):\n    ...\n\n@external\ndef claimIncentives(_user: address, _rewardToken: address, _rewardAmount: uint256, _proofs: DynArray[bytes32, MAX_PROOFS], _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256):\n    ...\n\n@external\ndef removeCollateral(_asset: address, _amount: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256):\n    ...\n\n@external\ndef addCollateral(_asset: address, _amount: uint256, _extraData: bytes32, _recipient: address, _miniAddys: ws.MiniAddys = empty(ws.MiniAddys)) -> (uint256, uint256):\n    ...\n\n@view\n@external\ndef getAccessForLego(_user: address, _action: ws.ActionType) -> (address, String[64], uint256):\n    ...\n\n@view\n@external\ndef hasCapability(_action: ws.ActionType) -> bool:\n    ...\n\n@view\n@external\ndef getRegistries() -> DynArray[address, 10]:\n    ...\n\n@view\n@external\ndef isYieldLego() -> bool:\n    ...\n\n@view\n@external\ndef isDexLego() -> bool:\n    ...\n\n\n# common\n\n\n@view\n@external\ndef isPaused() -> bool:\n    ...\n\n\n@external\ndef pause(_shouldPause: bool):\n    ...\n\n\n@external\ndef recoverFunds(_recipient: address, _asset: address):\n    ...\n\n\n@external\ndef recoverFundsMany(_recipient: address, _assets: DynArray[address, 20]):\n    ...",
            "sha256sum": "f2afb7bd72d4301aea77bbe4177b7ae954ba6f6b76af363965993eb92ad0b715"
          },
          "contracts/registries/LegoBook.vy": {
            "content": "#          ___       ___           ___           ___                ___           ___           ___           ___     \n#         /\\__\\     /\\  \\         /\\  \\         /\\  \\              /\\  \\         /\\  \\         /\\  \\         /\\__\\    \n#        /:/  /    /::\\  \\       /::\\  \\       /::\\  \\            /::\\  \\       /::\\  \\       /::\\  \\       /:/  /    \n#       /:/  /    /:/\\:\\  \\     /:/\\:\\  \\     /:/\\:\\  \\          /:/\\:\\  \\     /:/\\:\\  \\     /:/\\:\\  \\     /:/__/     \n#      /:/  /    /::\\~\\:\\  \\   /:/  \\:\\  \\   /:/  \\:\\  \\        /::\\~\\:\\__\\   /:/  \\:\\  \\   /:/  \\:\\  \\   /::\\__\\____ \n#     /:/__/    /:/\\:\\ \\:\\__\\ /:/__/_\\:\\__\\ /:/__/ \\:\\__\\      /:/\\:\\ \\:|__| /:/__/ \\:\\__\\ /:/__/ \\:\\__\\ /:/\\:::::\\__\\\n#     \\:\\  \\    \\:\\~\\:\\ \\/__/ \\:\\  /\\ \\/__/ \\:\\  \\ /:/  /      \\:\\~\\:\\/:/  / \\:\\  \\ /:/  / \\:\\  \\ /:/  / \\/_|:|~~|~   \n#      \\:\\  \\    \\:\\ \\:\\__\\    \\:\\ \\:\\__\\    \\:\\  /:/  /        \\:\\ \\::/  /   \\:\\  /:/  /   \\:\\  /:/  /     |:|  |    \n#       \\:\\  \\    \\:\\ \\/__/     \\:\\/:/  /     \\:\\/:/  /          \\:\\/:/  /     \\:\\/:/  /     \\:\\/:/  /      |:|  |    \n#        \\:\\__\\    \\:\\__\\        \\::/  /       \\::/  /            \\::/__/       \\::/  /       \\::/  /       |:|  |    \n#         \\/__/     \\/__/         \\/__/         \\/__/              ~~            \\/__/         \\/__/         \\|__|    \n#\n#     \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n#     \u2551  ** Lego Book **                                                               \u2551\n#     \u2551  Address registry for Legos (DeFi integrations -- yield protocols, DEXs, etc). \u2551\n#     \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n#\n#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\nimplements: Department\n\nexports: gov.__interface__\nexports: registry.__interface__\nexports: addys.__interface__\nexports: deptBasics.__interface__\n\ninitializes: gov\ninitializes: registry[gov := gov]\ninitializes: addys\ninitializes: deptBasics[addys := addys]\n\nimport contracts.modules.LocalGov as gov\nimport contracts.modules.AddressRegistry as registry\nimport contracts.modules.Addys as addys\nimport contracts.modules.DeptBasics as deptBasics\n\nfrom interfaces import LegoPartner as Lego\nfrom interfaces import Department\n\n\n\n@deploy\ndef __init__(\n    _undyHq: address,\n    _initialGov: address,\n    _minRegistryTimeLock: uint256,\n    _maxRegistryTimeLock: uint256,\n):\n    gov.__init__(_undyHq, _initialGov, 0, 0, 0)\n    registry.__init__(_minRegistryTimeLock, _maxRegistryTimeLock, 0, \"LegoBook.vy\")\n    addys.__init__(_undyHq)\n    deptBasics.__init__(False, False)\n\n\n@view\n@external\ndef isLegoAddr(_addr: address) -> bool:\n    return registry._isValidAddr(_addr)\n\n\n############\n# Registry #\n############\n\n\n# new address\n\n\n@external\ndef startAddNewAddressToRegistry(_addr: address, _description: String[64]) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._startAddNewAddressToRegistry(_addr, _description)\n\n\n@external\ndef confirmNewAddressToRegistry(_addr: address) -> uint256:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._confirmNewAddressToRegistry(_addr)\n\n\n@external\ndef cancelNewAddressToRegistry(_addr: address) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._cancelNewAddressToRegistry(_addr)\n\n\n# address update\n\n\n@external\ndef startAddressUpdateToRegistry(_regId: uint256, _newAddr: address) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._startAddressUpdateToRegistry(_regId, _newAddr)\n\n\n@external\ndef confirmAddressUpdateToRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._confirmAddressUpdateToRegistry(_regId)\n\n\n@external\ndef cancelAddressUpdateToRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._cancelAddressUpdateToRegistry(_regId)\n\n\n# address disable\n\n\n@external\ndef startAddressDisableInRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._startAddressDisableInRegistry(_regId)\n\n\n@external\ndef confirmAddressDisableInRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._confirmAddressDisableInRegistry(_regId)\n\n\n@external\ndef cancelAddressDisableInRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._cancelAddressDisableInRegistry(_regId)\n\n\n#############\n# Utilities #\n#############\n\n\n@view\n@internal\ndef _canPerformAction(_caller: address) -> bool:\n    return gov._canGovern(_caller) and not deptBasics.isPaused",
            "sha256sum": "40b3cb783554479fc17b89d70baaceb0bb98e772311c462e828d2e22fdfc51cf"
          }
        },
        "settings": {
          "outputSelection": {
            "contracts/registries/LegoBook.vy": [
              "*"
            ]
          },
          "search_paths": [
            "."
          ]
        },
        "compiler_version": "v0.4.3+commit.bff19ea2",
        "integrity": "34a6199eea03f83da00cd1a741accbedd6e74a53d35b76cf6595083004e5723a"
      },
      "args": "00000000000000000000000044cf3c4f000dfd76a35d03298049d37be688d6f90000000000000000000000003ed8174065c00fe511a91850cf8f45d161e8ee150000000000000000000000000000000000000000000000000000000000000e10000000000000000000000000000000000000000000000000000000000013c680",
      "file": "contracts/registries/LegoBook.vy"
    },
    "Helpers": {
      "address": "0x1980529E3FcC76393F70B538F62e499c27701EBa",
      "abi": [
        {
          "name": "GovChangeTimeLockModified",
          "inputs": [
            {
              "name": "prevTimeLock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "newTimeLock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "RegistryTimeLockModified",
          "inputs": [
            {
              "name": "newTimeLock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "prevTimeLock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "GovChangeStarted",
          "inputs": [
            {
              "name": "prevGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "newGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "GovChangeConfirmed",
          "inputs": [
            {
              "name": "prevGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "newGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "GovChangeCancelled",
          "inputs": [
            {
              "name": "cancelledGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "GovRelinquished",
          "inputs": [
            {
              "name": "prevGov",
              "type": "address",
              "indexed": true
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "UndyHqSetupFinished",
          "inputs": [
            {
              "name": "prevGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "newGov",
              "type": "address",
              "indexed": true
            },
            {
              "name": "timeLock",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "DepartmentPauseModified",
          "inputs": [
            {
              "name": "isPaused",
              "type": "bool",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "DepartmentFundsRecovered",
          "inputs": [
            {
              "name": "asset",
              "type": "address",
              "indexed": true
            },
            {
              "name": "recipient",
              "type": "address",
              "indexed": true
            },
            {
              "name": "balance",
              "type": "uint256",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "NewAddressPending",
          "inputs": [
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "NewAddressConfirmed",
          "inputs": [
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "NewAddressCancelled",
          "inputs": [
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressUpdatePending",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "newAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "prevAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "version",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressUpdateConfirmed",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "newAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "prevAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "version",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressUpdateCancelled",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "newAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "prevAddr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressDisablePending",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "version",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressDisableConfirmed",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "version",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "name": "AddressDisableCancelled",
          "inputs": [
            {
              "name": "regId",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "description",
              "type": "string",
              "indexed": false
            },
            {
              "name": "addr",
              "type": "address",
              "indexed": true
            },
            {
              "name": "initiatedBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "confirmBlock",
              "type": "uint256",
              "indexed": false
            },
            {
              "name": "registry",
              "type": "string",
              "indexed": false
            }
          ],
          "anonymous": false,
          "type": "event"
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUndyHqFromGov",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "canGovern",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getGovernors",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address[]"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "hasPendingGovChange",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "startGovernanceChange",
          "inputs": [
            {
              "name": "_newGov",
              "type": "address"
            }
          ],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "confirmGovernanceChange",
          "inputs": [],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "cancelGovernanceChange",
          "inputs": [],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "relinquishGov",
          "inputs": [],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "setGovTimeLock",
          "inputs": [
            {
              "name": "_numBlocks",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidGovTimeLock",
          "inputs": [
            {
              "name": "_newTimeLock",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "minGovChangeTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "maxGovChangeTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "finishUndyHqSetup",
          "inputs": [
            {
              "name": "_newGov",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "finishUndyHqSetup",
          "inputs": [
            {
              "name": "_newGov",
              "type": "address"
            },
            {
              "name": "_timeLock",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "governance",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "pendingGov",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "newGov",
                  "type": "address"
                },
                {
                  "name": "initiatedBlock",
                  "type": "uint256"
                },
                {
                  "name": "confirmBlock",
                  "type": "uint256"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "numGovChanges",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "govChangeTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRegistryDescription",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidNewAddress",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidAddressUpdate",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            },
            {
              "name": "_newAddr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidAddressDisable",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "setRegistryTimeLock",
          "inputs": [
            {
              "name": "_numBlocks",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidRegistryTimeLock",
          "inputs": [
            {
              "name": "_numBlocks",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "setRegistryTimeLockAfterSetup",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "setRegistryTimeLockAfterSetup",
          "inputs": [
            {
              "name": "_numBlocks",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "minRegistryTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "maxRegistryTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidAddr",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidRegId",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRegId",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddr",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddrInfo",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "addr",
                  "type": "address"
                },
                {
                  "name": "version",
                  "type": "uint256"
                },
                {
                  "name": "lastModified",
                  "type": "uint256"
                },
                {
                  "name": "description",
                  "type": "string"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddrDescription",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "string"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getNumAddrs",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getLastAddr",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getLastRegId",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "registryChangeTimeLock",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "addrInfo",
          "inputs": [
            {
              "name": "arg0",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "addr",
                  "type": "address"
                },
                {
                  "name": "version",
                  "type": "uint256"
                },
                {
                  "name": "lastModified",
                  "type": "uint256"
                },
                {
                  "name": "description",
                  "type": "string"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "addrToRegId",
          "inputs": [
            {
              "name": "arg0",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "numAddrs",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "pendingNewAddr",
          "inputs": [
            {
              "name": "arg0",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "description",
                  "type": "string"
                },
                {
                  "name": "initiatedBlock",
                  "type": "uint256"
                },
                {
                  "name": "confirmBlock",
                  "type": "uint256"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "pendingAddrUpdate",
          "inputs": [
            {
              "name": "arg0",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "newAddr",
                  "type": "address"
                },
                {
                  "name": "initiatedBlock",
                  "type": "uint256"
                },
                {
                  "name": "confirmBlock",
                  "type": "uint256"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "pendingAddrDisable",
          "inputs": [
            {
              "name": "arg0",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "initiatedBlock",
                  "type": "uint256"
                },
                {
                  "name": "confirmBlock",
                  "type": "uint256"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddys",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "hq",
                  "type": "address"
                },
                {
                  "name": "undyToken",
                  "type": "address"
                },
                {
                  "name": "ledger",
                  "type": "address"
                },
                {
                  "name": "missionControl",
                  "type": "address"
                },
                {
                  "name": "legoBook",
                  "type": "address"
                },
                {
                  "name": "switchboard",
                  "type": "address"
                },
                {
                  "name": "hatchery",
                  "type": "address"
                },
                {
                  "name": "lootDistributor",
                  "type": "address"
                },
                {
                  "name": "appraiser",
                  "type": "address"
                },
                {
                  "name": "walletBackpack",
                  "type": "address"
                },
                {
                  "name": "billing",
                  "type": "address"
                },
                {
                  "name": "vaultRegistry",
                  "type": "address"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUndyHq",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "canMintUndy",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "pause",
          "inputs": [
            {
              "name": "_shouldPause",
              "type": "bool"
            }
          ],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "recoverFunds",
          "inputs": [
            {
              "name": "_recipient",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            }
          ],
          "outputs": []
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "recoverFundsMany",
          "inputs": [
            {
              "name": "_recipient",
              "type": "address"
            },
            {
              "name": "_assets",
              "type": "address[]"
            }
          ],
          "outputs": []
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isPaused",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isHelpersAddr",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "startAddNewAddressToRegistry",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            },
            {
              "name": "_description",
              "type": "string"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "confirmNewAddressToRegistry",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "cancelNewAddressToRegistry",
          "inputs": [
            {
              "name": "_addr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "startAddressUpdateToRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            },
            {
              "name": "_newAddr",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "confirmAddressUpdateToRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "cancelAddressUpdateToRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "startAddressDisableInRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "confirmAddressDisableInRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "function",
          "name": "cancelAddressDisableInRegistry",
          "inputs": [
            {
              "name": "_regId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "constructor",
          "inputs": [
            {
              "name": "_undyHq",
              "type": "address"
            },
            {
              "name": "_tempGov",
              "type": "address"
            },
            {
              "name": "_minRegistryTimeLock",
              "type": "uint256"
            },
            {
              "name": "_maxRegistryTimeLock",
              "type": "uint256"
            }
          ],
          "outputs": []
        }
      ],
      "solc_json": {
        "language": "Vyper",
        "sources": {
          "contracts/modules/LocalGov.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\ninterface UndyHq:\n    def minGovChangeTimeLock() -> uint256: view\n    def maxGovChangeTimeLock() -> uint256: view\n    def governance() -> address: view\n\nstruct PendingGovernance:\n    newGov: address\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nevent GovChangeStarted:\n    prevGov: indexed(address)\n    newGov: indexed(address)\n    confirmBlock: uint256\n\nevent GovChangeConfirmed:\n    prevGov: indexed(address)\n    newGov: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nevent GovChangeCancelled:\n    cancelledGov: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nevent GovRelinquished:\n    prevGov: indexed(address)\n\nevent GovChangeTimeLockModified:\n    prevTimeLock: uint256\n    newTimeLock: uint256\n\nevent UndyHqSetupFinished:\n    prevGov: indexed(address)\n    newGov: indexed(address)\n    timeLock: uint256\n\n# governance\ngovernance: public(address)\npendingGov: public(PendingGovernance)\nnumGovChanges: public(uint256)\n\n# time lock\ngovChangeTimeLock: public(uint256)\n\n# config\nUNDY_HQ_FOR_GOV: immutable(address)\nMIN_GOV_TIME_LOCK: immutable(uint256)\nMAX_GOV_TIME_LOCK: immutable(uint256)\n\n\n@deploy\ndef __init__(\n    _undyHq: address,\n    _initialGov: address,\n    _minTimeLock: uint256,\n    _maxTimeLock: uint256,\n    _initialTimeLock: uint256,\n):\n    UNDY_HQ_FOR_GOV = _undyHq\n    self.governance = _initialGov\n\n    # undy hq\n    if _undyHq == empty(address):\n        assert _initialGov != empty(address) # dev: undy hq must have gov\n\n    # local gov (department, other smart contracts)\n    else:\n        hqGov: address = staticcall UndyHq(_undyHq).governance()\n        assert hqGov != empty(address) # dev: undy hq must have gov\n        assert _initialGov != hqGov # dev: undy hq cannot set same gov\n\n    # time locks\n    minTimeLock: uint256 = _minTimeLock\n    maxTimeLock: uint256 = _maxTimeLock\n    if minTimeLock == 0 or maxTimeLock == 0:\n        assert _undyHq != empty(address) # dev: need undy hq if no time locks\n        minTimeLock = staticcall UndyHq(_undyHq).minGovChangeTimeLock()\n        maxTimeLock = staticcall UndyHq(_undyHq).maxGovChangeTimeLock()\n\n    # set min and max time locks\n    assert minTimeLock < maxTimeLock # dev: invalid time lock\n    assert minTimeLock != 0 and maxTimeLock != max_value(uint256) # dev: invalid time lock\n    MIN_GOV_TIME_LOCK = minTimeLock\n    MAX_GOV_TIME_LOCK = maxTimeLock\n\n    # this contract is top level governance from Undy HQ -- not setting initial time lock during setup\n    if _undyHq == empty(address):\n        return\n\n    # set initial time lock (for local gov)\n    initialTimeLock: uint256 = max(minTimeLock, _initialTimeLock)\n    assert self._setGovTimeLock(initialTimeLock) # dev: invalid time lock\n\n\n@view\n@external\ndef getUndyHqFromGov() -> address:\n    return self._getUndyHqFromGov()\n\n\n@view\n@internal\ndef _getUndyHqFromGov() -> address:\n    return UNDY_HQ_FOR_GOV\n\n\n##############\n# Gov Access #\n##############\n\n\n@view\n@external\ndef canGovern(_addr: address) -> bool:\n    return self._canGovern(_addr)\n\n\n@view\n@internal\ndef _canGovern(_addr: address) -> bool:\n    if _addr == empty(address):\n        return False\n    return _addr in self._getGovernors()\n\n\n@view\n@external\ndef getGovernors() -> DynArray[address, 2]:\n    return self._getGovernors()\n\n\n@view\n@internal\ndef _getGovernors() -> DynArray[address, 2]:\n    governors: DynArray[address, 2] = []\n\n    # local governance\n    localGov: address = self.governance\n    if localGov != empty(address):\n        governors.append(localGov)\n\n    # undy hq governance\n    undyHq: address = UNDY_HQ_FOR_GOV\n    if undyHq == empty(address):\n        return governors\n\n    hqGov: address = staticcall UndyHq(undyHq).governance()\n    if hqGov != empty(address):\n        governors.append(hqGov)\n\n    return governors\n\n\n######################\n# Governance Changes #\n######################\n\n\n@view\n@external\ndef hasPendingGovChange() -> bool:\n    return self.pendingGov.confirmBlock != 0\n\n\n@view\n@internal\ndef _isUndyHq() -> bool:\n    return UNDY_HQ_FOR_GOV == empty(address)\n\n\n# start gov change\n\n\n@external\ndef startGovernanceChange(_newGov: address):\n    governors: DynArray[address, 2] = self._getGovernors()\n    assert msg.sender in governors # dev: no perms\n\n    # validation\n    if _newGov != empty(address):\n        assert _newGov not in governors # dev: invalid _newGov\n        assert _newGov.is_contract # dev: _newGov must be a contract\n    else:\n        assert not self._isUndyHq() # dev: undy hq cannot set 0x0\n\n    confirmBlock: uint256 = block.number + self.govChangeTimeLock\n    self.pendingGov = PendingGovernance(\n        newGov= _newGov,\n        initiatedBlock= block.number,\n        confirmBlock= confirmBlock,\n    )\n    log GovChangeStarted(prevGov=self.governance, newGov=_newGov, confirmBlock=confirmBlock)\n\n\n# confirm gov change\n\n\n@external\ndef confirmGovernanceChange():\n    data: PendingGovernance = self.pendingGov\n    assert data.confirmBlock != 0 and block.number >= data.confirmBlock # dev: time lock not reached\n\n    # check permissions\n    if data.newGov != empty(address):\n        assert msg.sender == data.newGov # dev: only new gov can confirm\n    else:\n        assert self._canGovern(msg.sender) # dev: no perms\n        assert not self._isUndyHq() # dev: undy hq cannot set 0x0\n\n    # set new governance\n    prevGov: address = self.governance\n    self.governance = data.newGov\n    self.numGovChanges += 1\n    self.pendingGov = empty(PendingGovernance)\n    log GovChangeConfirmed(prevGov=prevGov, newGov=data.newGov, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock)\n\n\n# cancel gov change\n\n\n@external\ndef cancelGovernanceChange():\n    assert self._canGovern(msg.sender) # dev: no perms\n    data: PendingGovernance = self.pendingGov\n    assert data.confirmBlock != 0 # dev: no pending change\n    self.pendingGov = empty(PendingGovernance)\n    log GovChangeCancelled(cancelledGov=data.newGov, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock)\n\n\n# relinquish gov (only for local gov)\n\n\n@external\ndef relinquishGov():\n    assert msg.sender == self.governance # dev: no perms\n    assert not self._isUndyHq() # dev: undy hq cannot relinquish gov\n\n    self.governance = empty(address)\n    self.numGovChanges += 1\n    log GovRelinquished(prevGov=msg.sender)\n\n\n####################\n# Time Lock Config #\n####################\n\n\n# set time lock\n\n\n@external\ndef setGovTimeLock(_numBlocks: uint256) -> bool:\n    assert self._canGovern(msg.sender) # dev: no perms\n    return self._setGovTimeLock(_numBlocks)\n\n\n@internal\ndef _setGovTimeLock(_numBlocks: uint256) -> bool:\n    prevTimeLock: uint256 = self.govChangeTimeLock\n    assert self._isValidGovTimeLock(_numBlocks, prevTimeLock) # dev: invalid time lock\n    self.govChangeTimeLock = _numBlocks\n    log GovChangeTimeLockModified(prevTimeLock=prevTimeLock, newTimeLock=_numBlocks)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidGovTimeLock(_newTimeLock: uint256) -> bool:\n    return self._isValidGovTimeLock(_newTimeLock, self.govChangeTimeLock)\n\n\n@view\n@internal\ndef _isValidGovTimeLock(_newTimeLock: uint256, _prevTimeLock: uint256) -> bool:\n    if _newTimeLock == _prevTimeLock:\n        return False # no change\n    if self.pendingGov.confirmBlock != 0:\n        return False # cannot change while pending gov change\n    return _newTimeLock >= MIN_GOV_TIME_LOCK and _newTimeLock <= MAX_GOV_TIME_LOCK\n\n\n# utils\n\n\n@view\n@external\ndef minGovChangeTimeLock() -> uint256:\n    return MIN_GOV_TIME_LOCK\n\n\n@view\n@external\ndef maxGovChangeTimeLock() -> uint256:\n    return MAX_GOV_TIME_LOCK\n\n\n#################\n# Undy Hq Setup #\n#################\n\n\n@external\ndef finishUndyHqSetup(_newGov: address, _timeLock: uint256 = 0) -> bool:\n    assert self._isUndyHq() # dev: only undy hq\n    assert msg.sender == self.governance # dev: no perms\n    assert self.numGovChanges == 0 # dev: already changed gov\n\n    # validation\n    assert _newGov != empty(address) and _newGov.is_contract # dev: invalid _newGov\n    prevGov: address = self.governance\n\n    # set new gov\n    self.governance = _newGov\n    self.numGovChanges += 1\n\n    # set time lock\n    timeLock: uint256 = _timeLock\n    if timeLock == 0:\n        timeLock = MIN_GOV_TIME_LOCK\n    assert self._setGovTimeLock(timeLock) # dev: invalid time lock\n\n    log UndyHqSetupFinished(prevGov=prevGov, newGov=_newGov, timeLock=timeLock)\n    return True",
            "sha256sum": "c41aa3e0d0d96b512171813377ea277e2c7da690c3cd9b4662733b3f11f705b0"
          },
          "contracts/modules/AddressRegistry.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\nuses: gov\nimport contracts.modules.LocalGov as gov\n\nstruct AddressInfo:\n    addr: address\n    version: uint256\n    lastModified: uint256\n    description: String[64]\n\nstruct PendingNewAddress:\n    description: String[64]\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nstruct PendingAddressUpdate:\n    newAddr: address\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nstruct PendingAddressDisable:\n    initiatedBlock: uint256\n    confirmBlock: uint256\n\nevent NewAddressPending:\n    addr: indexed(address)\n    description: String[64]\n    confirmBlock: uint256\n    registry: String[28]\n\nevent NewAddressConfirmed:\n    addr: indexed(address)\n    regId: uint256\n    description: String[64]\n    registry: String[28]\n\nevent NewAddressCancelled:\n    description: String[64]\n    addr: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent AddressUpdatePending:\n    regId: uint256\n    description: String[64]\n    newAddr: indexed(address)\n    prevAddr: indexed(address)\n    version: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent AddressUpdateConfirmed:\n    regId: uint256\n    description: String[64]\n    newAddr: indexed(address)\n    prevAddr: indexed(address)\n    version: uint256\n    registry: String[28]\n\nevent AddressUpdateCancelled:\n    regId: uint256\n    description: String[64]\n    newAddr: indexed(address)\n    prevAddr: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent AddressDisablePending:\n    regId: uint256\n    description: String[64]\n    addr: indexed(address)\n    version: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent AddressDisableConfirmed:\n    regId: uint256\n    description: String[64]\n    addr: indexed(address)\n    version: uint256\n    registry: String[28]\n\nevent AddressDisableCancelled:\n    regId: uint256\n    description: String[64]\n    addr: indexed(address)\n    initiatedBlock: uint256\n    confirmBlock: uint256\n    registry: String[28]\n\nevent RegistryTimeLockModified:\n    newTimeLock: uint256\n    prevTimeLock: uint256\n    registry: String[28]\n\n# time lock\nregistryChangeTimeLock: public(uint256)\n\n# core data (address registry)\naddrInfo: public(HashMap[uint256, AddressInfo]) # regId -> address info\naddrToRegId: public(HashMap[address, uint256]) # addr -> regId\nnumAddrs: public(uint256) # number of addrs in registry\n\n# pending changes\npendingNewAddr: public(HashMap[address, PendingNewAddress]) # addr -> pending new addr\npendingAddrUpdate: public(HashMap[uint256, PendingAddressUpdate]) # regId -> pending addr update\npendingAddrDisable: public(HashMap[uint256, PendingAddressDisable]) # regId -> pending addr disable\n\nREGISTRY_STR: immutable(String[28])\nMIN_REG_TIME_LOCK: immutable(uint256)\nMAX_REG_TIME_LOCK: immutable(uint256)\n\n\n@deploy\ndef __init__(\n    _minTimeLock: uint256,\n    _maxTimeLock: uint256,\n    _initialTimeLock: uint256,\n    _registryStr: String[28],\n):\n    REGISTRY_STR = _registryStr\n\n    assert _minTimeLock < _maxTimeLock # dev: invalid time lock\n    assert _minTimeLock != 0 and _maxTimeLock != max_value(uint256) # dev: invalid time lock\n    MIN_REG_TIME_LOCK = _minTimeLock\n    MAX_REG_TIME_LOCK = _maxTimeLock\n\n    # set initial time lock -- this may be zero during inital setup of registry\n    if _initialTimeLock != 0:\n        assert self._setRegistryTimeLock(_initialTimeLock) # dev: invalid time lock\n\n    # start at 1 index\n    self.numAddrs = 1\n\n\n@view\n@external\ndef getRegistryDescription() -> String[28]:\n    return REGISTRY_STR\n\n\n###############\n# New Address #\n###############\n\n\n# register new address\n\n\n@internal\ndef _startAddNewAddressToRegistry(_addr: address, _description: String[64]) -> bool:\n    assert self._isValidNewAddress(_addr) # dev: invalid addy\n\n    confirmBlock: uint256 = block.number + self.registryChangeTimeLock\n    self.pendingNewAddr[_addr] = PendingNewAddress(\n        description=_description,\n        initiatedBlock=block.number,\n        confirmBlock=confirmBlock,\n    )\n\n    log NewAddressPending(addr=_addr, description=_description, confirmBlock=confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# confirm new address\n\n\n@internal\ndef _confirmNewAddressToRegistry(_addr: address) -> uint256:\n    data: PendingNewAddress = self.pendingNewAddr[_addr]\n    assert data.confirmBlock != 0 and block.number >= data.confirmBlock # dev: time lock not reached\n\n    if not self._isValidNewAddress(_addr):\n        self.pendingNewAddr[_addr] = empty(PendingNewAddress) # clear pending\n        return 0\n\n    # register new addy\n    regId: uint256 = self.numAddrs\n    self.addrToRegId[_addr] = regId\n    self.numAddrs = regId + 1\n    self.addrInfo[regId] = AddressInfo(\n        addr=_addr,\n        version=1,\n        lastModified=block.timestamp,\n        description=data.description,\n    )\n\n    # clear pending\n    self.pendingNewAddr[_addr] = empty(PendingNewAddress)\n\n    log NewAddressConfirmed(addr=_addr, regId=regId, description=data.description, registry=REGISTRY_STR)\n    return regId\n\n\n# cancel new address\n\n\n@internal\ndef _cancelNewAddressToRegistry(_addr: address) -> bool:\n    data: PendingNewAddress = self.pendingNewAddr[_addr]\n    assert data.confirmBlock != 0 # dev: no pending\n\n    self.pendingNewAddr[_addr] = empty(PendingNewAddress)\n    log NewAddressCancelled(description=data.description, addr=_addr, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidNewAddress(_addr: address) -> bool:\n    return self._isValidNewAddress(_addr)\n\n\n@view\n@internal\ndef _isValidNewAddress(_addr: address) -> bool:\n    if _addr == empty(address) or not _addr.is_contract:\n        return False\n    return self.addrToRegId[_addr] == 0\n\n\n###################\n# Address Updates #\n###################\n\n\n# update address\n\n\n@internal\ndef _startAddressUpdateToRegistry(_regId: uint256, _newAddr: address) -> bool:\n    data: AddressInfo = self.addrInfo[_regId]\n    assert self._isValidAddressUpdate(_regId, _newAddr, data.addr) # dev: invalid update\n\n    # set pending\n    confirmBlock: uint256 = block.number + self.registryChangeTimeLock\n    self.pendingAddrUpdate[_regId] = PendingAddressUpdate(\n        newAddr=_newAddr,\n        initiatedBlock=block.number,\n        confirmBlock=confirmBlock,\n    )\n\n    log AddressUpdatePending(regId=_regId, description=data.description, newAddr=_newAddr, prevAddr=data.addr, version=data.version, confirmBlock=confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# confirm update address\n\n\n@internal\ndef _confirmAddressUpdateToRegistry(_regId: uint256) -> bool:\n    newData: PendingAddressUpdate = self.pendingAddrUpdate[_regId]\n    assert newData.confirmBlock != 0 and block.number >= newData.confirmBlock # dev: time lock not reached\n\n    data: AddressInfo = self.addrInfo[_regId]\n    prevAddr: address = data.addr # needed for later\n    if not self._isValidAddressUpdate(_regId, newData.newAddr, prevAddr):\n        self.pendingAddrUpdate[_regId] = empty(PendingAddressUpdate) # clear pending\n        return False\n\n    # update addy data\n    data.addr = newData.newAddr\n    data.lastModified = block.timestamp\n    data.version += 1\n    self.addrInfo[_regId] = data\n    self.addrToRegId[newData.newAddr] = _regId\n\n    # handle previous addr\n    if prevAddr != empty(address):\n        self.addrToRegId[prevAddr] = 0\n\n    # clear pending\n    self.pendingAddrUpdate[_regId] = empty(PendingAddressUpdate)\n\n    log AddressUpdateConfirmed(regId=_regId, description=data.description, newAddr=newData.newAddr, prevAddr=prevAddr, version=data.version, registry=REGISTRY_STR)\n    return True\n\n\n# cancel update address\n\n\n@internal\ndef _cancelAddressUpdateToRegistry(_regId: uint256) -> bool:\n    data: PendingAddressUpdate = self.pendingAddrUpdate[_regId]\n    assert data.confirmBlock != 0 # dev: no pending\n\n    self.pendingAddrUpdate[_regId] = empty(PendingAddressUpdate)\n    prevData: AddressInfo = self.addrInfo[_regId]\n    log AddressUpdateCancelled(regId=_regId, description=prevData.description, newAddr=data.newAddr, prevAddr=prevData.addr, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidAddressUpdate(_regId: uint256, _newAddr: address) -> bool:\n    return self._isValidAddressUpdate(_regId, _newAddr, self.addrInfo[_regId].addr)\n\n\n@view\n@internal\ndef _isValidAddressUpdate(_regId: uint256, _newAddr: address, _prevAddr: address) -> bool:\n    if not self._isValidRegId(_regId):\n        return False\n    if not self._isValidNewAddress(_newAddr):\n        return False\n    return _newAddr != _prevAddr\n\n\n###################\n# Disable Address #\n###################\n\n\n# start disable address\n\n\n@internal\ndef _startAddressDisableInRegistry(_regId: uint256) -> bool:\n    data: AddressInfo = self.addrInfo[_regId]\n    assert self._isValidAddressDisable(_regId, data.addr) # dev: invalid disable\n\n    # set pending\n    confirmBlock: uint256 = block.number + self.registryChangeTimeLock\n    self.pendingAddrDisable[_regId] = PendingAddressDisable(\n        initiatedBlock=block.number,\n        confirmBlock=confirmBlock,\n    )\n\n    log AddressDisablePending(regId=_regId, description=data.description, addr=data.addr, version=data.version, confirmBlock=confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# confirm disable address\n\n\n@internal\ndef _confirmAddressDisableInRegistry(_regId: uint256) -> bool:\n    newData: PendingAddressDisable = self.pendingAddrDisable[_regId]\n    assert newData.confirmBlock != 0 and block.number >= newData.confirmBlock # dev: time lock not reached\n\n    data: AddressInfo = self.addrInfo[_regId]\n    prevAddr: address = data.addr # needed for later\n    if not self._isValidAddressDisable(_regId, prevAddr):\n        self.pendingAddrDisable[_regId] = empty(PendingAddressDisable) # clear pending\n        return False\n\n    # disable addy\n    data.addr = empty(address)\n    data.lastModified = block.timestamp\n    data.version += 1\n    self.addrInfo[_regId] = data\n    self.addrToRegId[prevAddr] = 0\n\n    # clear pending\n    self.pendingAddrDisable[_regId] = empty(PendingAddressDisable)\n\n    log AddressDisableConfirmed(regId=_regId, description=data.description, addr=prevAddr, version=data.version, registry=REGISTRY_STR)\n    return True\n\n\n# cancel disable address\n\n\n@internal\ndef _cancelAddressDisableInRegistry(_regId: uint256) -> bool:\n    data: PendingAddressDisable = self.pendingAddrDisable[_regId]\n    assert data.confirmBlock != 0 # dev: no pending\n\n    self.pendingAddrDisable[_regId] = empty(PendingAddressDisable)\n    prevData: AddressInfo = self.addrInfo[_regId]\n    log AddressDisableCancelled(regId=_regId, description=prevData.description, addr=prevData.addr, initiatedBlock=data.initiatedBlock, confirmBlock=data.confirmBlock, registry=REGISTRY_STR)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidAddressDisable(_regId: uint256) -> bool:\n    return self._isValidAddressDisable(_regId, self.addrInfo[_regId].addr)\n\n\n@view\n@internal\ndef _isValidAddressDisable(_regId: uint256, _prevAddr: address) -> bool:\n    if not self._isValidRegId(_regId):\n        return False\n    return _prevAddr != empty(address)\n\n\n####################\n# Time Lock Config #\n####################\n\n\n@external\ndef setRegistryTimeLock(_numBlocks: uint256) -> bool:\n    assert gov._canGovern(msg.sender) # dev: no perms\n    return self._setRegistryTimeLock(_numBlocks)\n\n\n@internal\ndef _setRegistryTimeLock(_numBlocks: uint256) -> bool:\n    prevTimeLock: uint256 = self.registryChangeTimeLock\n    assert self._isValidRegistryTimeLock(_numBlocks, prevTimeLock) # dev: invalid time lock\n    self.registryChangeTimeLock = _numBlocks\n    log RegistryTimeLockModified(newTimeLock=_numBlocks, prevTimeLock=prevTimeLock, registry=REGISTRY_STR)\n    return True\n\n\n# validation\n\n\n@view\n@external\ndef isValidRegistryTimeLock(_numBlocks: uint256) -> bool:\n    return self._isValidRegistryTimeLock(_numBlocks, self.registryChangeTimeLock)\n\n\n@view\n@internal\ndef _isValidRegistryTimeLock(_newTimeLock: uint256, _prevTimeLock: uint256) -> bool:\n    if _newTimeLock == _prevTimeLock:\n        return False\n    return _newTimeLock >= MIN_REG_TIME_LOCK and _newTimeLock <= MAX_REG_TIME_LOCK\n\n\n# finish setup\n\n\n@external\ndef setRegistryTimeLockAfterSetup(_numBlocks: uint256 = 0) -> bool:\n    assert gov._canGovern(msg.sender) # dev: no perms\n    assert self.registryChangeTimeLock == 0 # dev: already set\n\n    timeLock: uint256 = _numBlocks\n    if timeLock == 0:\n        timeLock = MIN_REG_TIME_LOCK\n    return self._setRegistryTimeLock(timeLock)\n\n\n# utils\n\n\n@view\n@external\ndef minRegistryTimeLock() -> uint256:\n    return MIN_REG_TIME_LOCK\n\n\n@view\n@external\ndef maxRegistryTimeLock() -> uint256:\n    return MAX_REG_TIME_LOCK\n\n\n#################\n# Views / Utils #\n#################\n\n\n# is valid addr\n\n\n@view\n@external\ndef isValidAddr(_addr: address) -> bool:\n    return self._isValidAddr(_addr)\n\n\n@view\n@internal\ndef _isValidAddr(_addr: address) -> bool:\n    return self.addrToRegId[_addr] != 0\n\n\n# is valid addr id\n\n\n@view\n@external\ndef isValidRegId(_regId: uint256) -> bool:\n    return self._isValidRegId(_regId)\n\n\n@view\n@internal\ndef _isValidRegId(_regId: uint256) -> bool:\n    return _regId != 0 and _regId < self.numAddrs\n\n\n# get reg id\n\n\n@view\n@external\ndef getRegId(_addr: address) -> uint256:\n    return self._getRegId(_addr)\n\n\n@view\n@internal\ndef _getRegId(_addr: address) -> uint256:\n    return self.addrToRegId[_addr]\n\n\n# get addr\n\n\n@view\n@external\ndef getAddr(_regId: uint256) -> address:\n    return self._getAddr(_regId)\n\n\n@view\n@internal\ndef _getAddr(_regId: uint256) -> address:\n    return self.addrInfo[_regId].addr\n\n\n# get addr info\n\n\n@view\n@external\ndef getAddrInfo(_regId: uint256) -> AddressInfo:\n    return self._getAddrInfo(_regId)\n\n\n@view\n@internal\ndef _getAddrInfo(_regId: uint256) -> AddressInfo:\n    return self.addrInfo[_regId]\n\n\n# get addr description\n\n\n@view\n@external\ndef getAddrDescription(_regId: uint256) -> String[64]:\n    return self._getAddrDescription(_regId)\n\n\n@view\n@internal\ndef _getAddrDescription(_regId: uint256) -> String[64]:\n    return self.addrInfo[_regId].description\n\n\n# get num addrs\n\n\n@view\n@external\ndef getNumAddrs() -> uint256:\n    return self._getNumAddrs()\n\n\n@view\n@internal\ndef _getNumAddrs() -> uint256:\n    return self.numAddrs - 1\n\n\n# get last addr\n\n\n@view\n@external\ndef getLastAddr() -> address:\n    return self._getLastAddr()\n\n\n@view\n@internal\ndef _getLastAddr() -> address:\n    lastRegId: uint256 = self.numAddrs - 1\n    return self.addrInfo[lastRegId].addr\n\n\n# get last reg id\n\n\n@view\n@external\ndef getLastRegId() -> uint256:\n    return self._getLastRegId()\n\n\n@view\n@internal\ndef _getLastRegId() -> uint256:\n    return self.numAddrs - 1\n",
            "sha256sum": "b88f6fc85ae3cd815c5a476c620b2fb5494b4dec5f1ce738878eded11c46396b"
          },
          "contracts/modules/Addys.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\ninterface UndyHq:\n    def isValidAddr(_addr: address) -> bool: view\n    def getAddr(_regId: uint256) -> address: view\n    def undyToken() -> address: view\n\ninterface Switchboard:\n    def isSwitchboardAddr(_addr: address) -> bool: view\n\ninterface LegoBook:\n    def isLegoAddr(_addr: address) -> bool: view\n\nstruct Addys:\n    hq: address\n    undyToken: address\n    ledger: address\n    missionControl: address\n    legoBook: address\n    switchboard: address\n    hatchery: address\n    lootDistributor: address\n    appraiser: address\n    walletBackpack: address\n    billing: address\n    vaultRegistry: address\n\n# hq\nUNDY_HQ_FOR_ADDYS: immutable(address)\n\n# core addys\nLEDGER_ID: constant(uint256) = 1\nMISSION_CONTROL_ID: constant(uint256) = 2\nLEGO_BOOK_ID: constant(uint256) = 3\nSWITCHBOARD_ID: constant(uint256) = 4\nHATCHERY_ID: constant(uint256) = 5\nLOOT_DISTRIBUTOR_ID: constant(uint256) = 6\nAPPRAISER_ID: constant(uint256) = 7\nWALLET_BACKPACK_ID: constant(uint256) = 8\nBILLING_ID: constant(uint256) = 9\nVAULT_REGISTRY_ID: constant(uint256) = 10\nHELPERS_ID: constant(uint256) = 11\n\n\n@deploy\ndef __init__(_undyHq: address):\n    assert _undyHq != empty(address) # dev: invalid undy hq\n    UNDY_HQ_FOR_ADDYS = _undyHq\n\n\n########\n# Core #\n########\n\n\n@view\n@external\ndef getAddys() -> Addys:\n    return self._generateAddys()\n\n\n@view\n@internal\ndef _getAddys(_addys: Addys = empty(Addys)) -> Addys:\n    if _addys.hq != empty(address):\n        return _addys\n    return self._generateAddys()\n\n\n@view\n@internal\ndef _generateAddys() -> Addys:\n    hq: address = UNDY_HQ_FOR_ADDYS\n    return Addys(\n        hq = hq,\n        undyToken = staticcall UndyHq(hq).undyToken(),\n        ledger = staticcall UndyHq(hq).getAddr(LEDGER_ID),\n        missionControl = staticcall UndyHq(hq).getAddr(MISSION_CONTROL_ID),\n        legoBook = staticcall UndyHq(hq).getAddr(LEGO_BOOK_ID),\n        switchboard = staticcall UndyHq(hq).getAddr(SWITCHBOARD_ID),\n        hatchery = staticcall UndyHq(hq).getAddr(HATCHERY_ID),\n        lootDistributor = staticcall UndyHq(hq).getAddr(LOOT_DISTRIBUTOR_ID),\n        appraiser = staticcall UndyHq(hq).getAddr(APPRAISER_ID),\n        walletBackpack = staticcall UndyHq(hq).getAddr(WALLET_BACKPACK_ID),\n        billing = staticcall UndyHq(hq).getAddr(BILLING_ID),\n        vaultRegistry = staticcall UndyHq(hq).getAddr(VAULT_REGISTRY_ID),\n    )\n\n\n##########\n# Tokens #\n##########\n\n\n@view\n@internal\ndef _getUndyToken() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).undyToken()\n\n\n###########\n# Helpers #\n###########\n\n\n# undy hq\n\n\n@view\n@external\ndef getUndyHq() -> address:\n    return self._getUndyHq()\n\n\n@view\n@internal\ndef _getUndyHq() -> address:\n    return UNDY_HQ_FOR_ADDYS\n\n\n# utils\n\n\n@view\n@internal\ndef _isValidUndyAddr(_addr: address, _hq: address = empty(address)) -> bool:\n    hq: address = _hq\n    if _hq == empty(address):\n        hq = UNDY_HQ_FOR_ADDYS\n    \n    # core departments\n    if staticcall UndyHq(hq).isValidAddr(_addr):\n        return True\n\n    # lego book\n    legoBook: address = staticcall UndyHq(hq).getAddr(LEGO_BOOK_ID)\n    if legoBook != empty(address) and staticcall LegoBook(legoBook).isLegoAddr(_addr):\n        return True\n\n    # switchboard config\n    switchboard: address = staticcall UndyHq(hq).getAddr(SWITCHBOARD_ID)\n    if switchboard != empty(address) and staticcall Switchboard(switchboard).isSwitchboardAddr(_addr):\n        return True\n\n    return False\n\n\n@view\n@internal\ndef _isSwitchboardAddr(_addr: address) -> bool:\n    switchboard: address = staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(SWITCHBOARD_ID)\n    if switchboard == empty(address):\n        return False\n    return staticcall Switchboard(switchboard).isSwitchboardAddr(_addr)\n\n\n@view\n@internal\ndef _isLegoBookAddr(_addr: address) -> bool:\n    legoBook: address = staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEGO_BOOK_ID)\n    if legoBook == empty(address):\n        return False\n    return staticcall LegoBook(legoBook).isLegoAddr(_addr)\n\n\n###############\n# Departments #\n###############\n\n\n# ledger\n\n\n@view\n@internal\ndef _getLedgerId() -> uint256:\n    return LEDGER_ID\n\n\n@view\n@internal\ndef _getLedgerAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEDGER_ID)\n\n\n# mission control\n\n\n@view\n@internal\ndef _getMissionControlId() -> uint256:\n    return MISSION_CONTROL_ID\n\n\n@view\n@internal\ndef _getMissionControlAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(MISSION_CONTROL_ID)\n\n\n# lego book\n\n\n@view\n@internal\ndef _getLegoBookId() -> uint256:\n    return LEGO_BOOK_ID\n\n\n@view\n@internal\ndef _getLegoBookAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEGO_BOOK_ID)\n\n\n# switchboard\n\n\n@view\n@internal\ndef _getSwitchboardId() -> uint256:\n    return SWITCHBOARD_ID\n\n\n@view\n@internal\ndef _getSwitchboardAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(SWITCHBOARD_ID)\n\n\n# hatchery\n\n\n@view\n@internal\ndef _getHatcheryId() -> uint256:\n    return HATCHERY_ID\n\n\n@view\n@internal\ndef _getHatcheryAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(HATCHERY_ID)\n\n\n# loot distributor\n\n\n@view\n@internal\ndef _getLootDistributorId() -> uint256:\n    return LOOT_DISTRIBUTOR_ID\n\n\n@view\n@internal\ndef _getLootDistributorAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LOOT_DISTRIBUTOR_ID)\n\n\n# appraiser\n\n\n@view\n@internal\ndef _getAppraiserId() -> uint256:\n    return APPRAISER_ID\n\n\n@view\n@internal\ndef _getAppraiserAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(APPRAISER_ID)\n\n\n# wallet backpack\n\n\n@view\n@internal\ndef _getWalletBackpackId() -> uint256:\n    return WALLET_BACKPACK_ID\n\n\n@view\n@internal\ndef _getWalletBackpackAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(WALLET_BACKPACK_ID)\n\n\n# billing\n\n\n@view\n@internal\ndef _getBillingId() -> uint256:\n    return BILLING_ID\n\n\n@view\n@internal\ndef _getBillingAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(BILLING_ID)\n\n\n# vault registry\n\n\n@view\n@internal\ndef _getVaultRegistryId() -> uint256:\n    return VAULT_REGISTRY_ID\n\n\n@view\n@internal\ndef _getVaultRegistryAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(VAULT_REGISTRY_ID)\n\n\n# helpers\n\n\n@view\n@internal\ndef _getHelpersId() -> uint256:\n    return HELPERS_ID\n\n\n@view\n@internal\ndef _getHelpersAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(HELPERS_ID)",
            "sha256sum": "f550bb73a39fbf28fbeb23943f6c870a2f9a4263ded93b50950ed42ea0346155"
          },
          "interfaces/Department.vyi": {
            "content": "# @version 0.4.3\n\n\n###########\n# Minting #\n###########\n\n\n@view\n@external\ndef canMintUndy() -> bool:\n    # used in UndyHq.vy\n    ...\n\n\n########\n# Undy #\n########\n\n\n@view\n@external\ndef isPaused() -> bool:\n    ...\n\n\n@external\ndef pause(_shouldPause: bool):\n    ...\n\n\n@external\ndef recoverFunds(_recipient: address, _asset: address):\n    ...\n\n@external\ndef recoverFundsMany(_recipient: address, _assets: DynArray[address, 20]):\n    ...",
            "sha256sum": "53e48da591c4ee36045a8950c9d3a01458456b471b797df536e9a9f54404e721"
          },
          "contracts/modules/DeptBasics.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\nuses: addys\nimplements: dept\n\nimport contracts.modules.Addys as addys\nimport interfaces.Department as dept\nfrom ethereum.ercs import IERC20\n\nevent DepartmentPauseModified:\n    isPaused: bool\n\nevent DepartmentFundsRecovered:\n    asset: indexed(address)\n    recipient: indexed(address)\n    balance: uint256\n\nisPaused: public(bool)\n\nCAN_MINT_UNDY: immutable(bool)\nMAX_RECOVER_ASSETS: constant(uint256) = 20\n\n\n@deploy\ndef __init__(_shouldPause: bool, _canMintUndy: bool):\n    self.isPaused = _shouldPause\n    CAN_MINT_UNDY = _canMintUndy\n\n\n###########\n# Minting #\n###########\n\n\n@view\n@external\ndef canMintUndy() -> bool:\n    return CAN_MINT_UNDY\n\n\n########\n# Undy #\n########\n\n\n# activate\n\n\n@external\ndef pause(_shouldPause: bool):\n    assert addys._isSwitchboardAddr(msg.sender) # dev: no perms\n    assert _shouldPause != self.isPaused # dev: no change\n    self.isPaused = _shouldPause\n    log DepartmentPauseModified(isPaused=_shouldPause)\n\n\n# recover funds\n\n\n@external\ndef recoverFunds(_recipient: address, _asset: address):\n    assert addys._isSwitchboardAddr(msg.sender) # dev: no perms\n    self._recoverFunds(_recipient, _asset)\n\n\n@external\ndef recoverFundsMany(_recipient: address, _assets: DynArray[address, MAX_RECOVER_ASSETS]):\n    assert addys._isSwitchboardAddr(msg.sender) # dev: no perms\n    for a: address in _assets:\n        self._recoverFunds(_recipient, a)\n\n\n@internal\ndef _recoverFunds(_recipient: address, _asset: address):\n    assert empty(address) not in [_recipient, _asset] # dev: invalid recipient or asset\n    balance: uint256 = staticcall IERC20(_asset).balanceOf(self)\n    assert balance != 0 # dev: nothing to recover\n\n    assert extcall IERC20(_asset).transfer(_recipient, balance, default_return_value=True) # dev: recovery failed\n    log DepartmentFundsRecovered(asset=_asset, recipient=_recipient, balance=balance)\n",
            "sha256sum": "976a50a3807bcf71f3f1c57de5cd7a59fe4e8f27b4d4560e774073962f44d1ac"
          },
          "contracts/registries/Helpers.vy": {
            "content": "#     __  __     ______     __         ______   ______     ______     ______    \n#    /\\ \\_\\ \\   /\\  ___\\   /\\ \\       /\\  == \\ /\\  ___\\   /\\  == \\   /\\  ___\\   \n#    \\ \\  __ \\  \\ \\  __\\   \\ \\ \\____  \\ \\  _-/ \\ \\  __\\   \\ \\  __<   \\ \\___  \\  \n#     \\ \\_\\ \\_\\  \\ \\_____\\  \\ \\_____\\  \\ \\_\\    \\ \\_____\\  \\ \\_\\ \\_\\  \\/\\_____\\ \n#      \\/_/\\/_/   \\/_____/   \\/_____/   \\/_/     \\/_____/   \\/_/ /_/   \\/_____/ \n#\n#     \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n#     \u2551  ** Helpers **                         \u2551\n#     \u2551  Registry for all helper contracts     \u2551\n#     \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n#\n#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\nimplements: Department\n\nexports: gov.__interface__\nexports: registry.__interface__\nexports: addys.__interface__\nexports: deptBasics.__interface__\n\ninitializes: gov\ninitializes: registry[gov := gov]\ninitializes: addys\ninitializes: deptBasics[addys := addys]\n\nimport contracts.modules.LocalGov as gov\nimport contracts.modules.AddressRegistry as registry\nimport contracts.modules.Addys as addys\nimport contracts.modules.DeptBasics as deptBasics\n\nfrom interfaces import Department\n\n\n@deploy\ndef __init__(\n    _undyHq: address,\n    _tempGov: address,\n    _minRegistryTimeLock: uint256,\n    _maxRegistryTimeLock: uint256,\n):\n    gov.__init__(_undyHq, _tempGov, 0, 0, 0)\n    registry.__init__(_minRegistryTimeLock, _maxRegistryTimeLock, 0, \"Helpers.vy\")\n    addys.__init__(_undyHq)\n    deptBasics.__init__(False, False) # no minting\n\n\n@view\n@external\ndef isHelpersAddr(_addr: address) -> bool:\n    return registry._isValidAddr(_addr)\n\n\n############\n# Registry #\n############\n\n\n# new address\n\n\n@external\ndef startAddNewAddressToRegistry(_addr: address, _description: String[64]) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._startAddNewAddressToRegistry(_addr, _description)\n\n\n@external\ndef confirmNewAddressToRegistry(_addr: address) -> uint256:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._confirmNewAddressToRegistry(_addr)\n\n\n@external\ndef cancelNewAddressToRegistry(_addr: address) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._cancelNewAddressToRegistry(_addr)\n\n\n# address update\n\n\n@external\ndef startAddressUpdateToRegistry(_regId: uint256, _newAddr: address) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._startAddressUpdateToRegistry(_regId, _newAddr)\n\n\n@external\ndef confirmAddressUpdateToRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._confirmAddressUpdateToRegistry(_regId)\n\n\n@external\ndef cancelAddressUpdateToRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._cancelAddressUpdateToRegistry(_regId)\n\n\n# address disable\n\n\n@external\ndef startAddressDisableInRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._startAddressDisableInRegistry(_regId)\n\n\n@external\ndef confirmAddressDisableInRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._confirmAddressDisableInRegistry(_regId)\n\n\n@external\ndef cancelAddressDisableInRegistry(_regId: uint256) -> bool:\n    assert self._canPerformAction(msg.sender) # dev: no perms\n    return registry._cancelAddressDisableInRegistry(_regId)\n\n\n#############\n# Utilities #\n#############\n\n\n@view\n@internal\ndef _canPerformAction(_caller: address) -> bool:\n    return gov._canGovern(_caller) and not deptBasics.isPaused",
            "sha256sum": "92799cdd150acbb5e35e1327023ecd0576767b97ed6f9020df067d6f816000cd"
          }
        },
        "settings": {
          "outputSelection": {
            "contracts/registries/Helpers.vy": [
              "*"
            ]
          },
          "search_paths": [
            "."
          ]
        },
        "compiler_version": "v0.4.3+commit.bff19ea2",
        "integrity": "0beeb5343dc0e1f4cd684082d9b8ce2406be857c064c2cfc6b0a619f590f3fd7"
      },
      "args": "00000000000000000000000044cf3c4f000dfd76a35d03298049d37be688d6f90000000000000000000000003ed8174065c00fe511a91850cf8f45d161e8ee150000000000000000000000000000000000000000000000000000000000000e10000000000000000000000000000000000000000000000000000000000013c680",
      "file": "contracts/registries/Helpers.vy"
    },
    "LevgVaultTools": {
      "address": "0xbCfC93bbF48423fd033af30573afce75bDc6C3f4",
      "abi": [
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddys",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "hq",
                  "type": "address"
                },
                {
                  "name": "undyToken",
                  "type": "address"
                },
                {
                  "name": "ledger",
                  "type": "address"
                },
                {
                  "name": "missionControl",
                  "type": "address"
                },
                {
                  "name": "legoBook",
                  "type": "address"
                },
                {
                  "name": "switchboard",
                  "type": "address"
                },
                {
                  "name": "hatchery",
                  "type": "address"
                },
                {
                  "name": "lootDistributor",
                  "type": "address"
                },
                {
                  "name": "appraiser",
                  "type": "address"
                },
                {
                  "name": "walletBackpack",
                  "type": "address"
                },
                {
                  "name": "billing",
                  "type": "address"
                },
                {
                  "name": "vaultRegistry",
                  "type": "address"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUndyHq",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalUnderlyingAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalUnderlyingAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalUnderlyingAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalUnderlyingAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalUnderlyingAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAmountForAsset",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAmountForAsset",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAmountForAsset",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAmountForAsset",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAmountForAsset",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmountForVaultToken",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmountForVaultToken",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmountForVaultToken",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmountForVaultToken",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmountForVaultToken",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRipeCollateralBalance",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRipeCollateralBalance",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRipeCollateralBalance",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRipeCollateralBalance",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getRipeCollateralBalance",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingGreenAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingGreenAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingGreenAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingGreenAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingGreenAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingGreenAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getBorrowRate",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getBorrowRate",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getDebtAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getDebtAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTrueMaxBorrowAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTrueMaxBorrowAmount",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_netUserCapital",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_netUserCapital",
              "type": "uint256"
            },
            {
              "name": "_maxDebtRatio",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_netUserCapital",
              "type": "uint256"
            },
            {
              "name": "_maxDebtRatio",
              "type": "uint256"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_netUserCapital",
              "type": "uint256"
            },
            {
              "name": "_maxDebtRatio",
              "type": "uint256"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_netUserCapital",
              "type": "uint256"
            },
            {
              "name": "_maxDebtRatio",
              "type": "uint256"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByMaxDebtRatio",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_netUserCapital",
              "type": "uint256"
            },
            {
              "name": "_maxDebtRatio",
              "type": "uint256"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByRipeLtv",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByRipeLtv",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_creditEngine",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmountByRipeLtv",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_creditEngine",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getVaultTokenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getVaultTokenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getVaultTokenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getVaultTokenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUnderlyingAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_isCollateralAsset",
              "type": "bool"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getGreenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getGreenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getGreenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getGreenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getGreenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getGreenAmounts",
          "inputs": [
            {
              "name": "_levgVault",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_ripeVaultBook",
              "type": "address"
            },
            {
              "name": "_ripeMissionControl",
              "type": "address"
            },
            {
              "name": "_ripeHq",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            },
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "RIPE_REGISTRY",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "GREEN_TOKEN",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "SAVINGS_GREEN",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "USDC",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "constructor",
          "inputs": [
            {
              "name": "_undyHq",
              "type": "address"
            },
            {
              "name": "_ripeRegistry",
              "type": "address"
            },
            {
              "name": "_usdc",
              "type": "address"
            }
          ],
          "outputs": []
        }
      ],
      "solc_json": {
        "language": "Vyper",
        "sources": {
          "contracts/modules/Addys.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\ninterface UndyHq:\n    def isValidAddr(_addr: address) -> bool: view\n    def getAddr(_regId: uint256) -> address: view\n    def undyToken() -> address: view\n\ninterface Switchboard:\n    def isSwitchboardAddr(_addr: address) -> bool: view\n\ninterface LegoBook:\n    def isLegoAddr(_addr: address) -> bool: view\n\nstruct Addys:\n    hq: address\n    undyToken: address\n    ledger: address\n    missionControl: address\n    legoBook: address\n    switchboard: address\n    hatchery: address\n    lootDistributor: address\n    appraiser: address\n    walletBackpack: address\n    billing: address\n    vaultRegistry: address\n\n# hq\nUNDY_HQ_FOR_ADDYS: immutable(address)\n\n# core addys\nLEDGER_ID: constant(uint256) = 1\nMISSION_CONTROL_ID: constant(uint256) = 2\nLEGO_BOOK_ID: constant(uint256) = 3\nSWITCHBOARD_ID: constant(uint256) = 4\nHATCHERY_ID: constant(uint256) = 5\nLOOT_DISTRIBUTOR_ID: constant(uint256) = 6\nAPPRAISER_ID: constant(uint256) = 7\nWALLET_BACKPACK_ID: constant(uint256) = 8\nBILLING_ID: constant(uint256) = 9\nVAULT_REGISTRY_ID: constant(uint256) = 10\nHELPERS_ID: constant(uint256) = 11\n\n\n@deploy\ndef __init__(_undyHq: address):\n    assert _undyHq != empty(address) # dev: invalid undy hq\n    UNDY_HQ_FOR_ADDYS = _undyHq\n\n\n########\n# Core #\n########\n\n\n@view\n@external\ndef getAddys() -> Addys:\n    return self._generateAddys()\n\n\n@view\n@internal\ndef _getAddys(_addys: Addys = empty(Addys)) -> Addys:\n    if _addys.hq != empty(address):\n        return _addys\n    return self._generateAddys()\n\n\n@view\n@internal\ndef _generateAddys() -> Addys:\n    hq: address = UNDY_HQ_FOR_ADDYS\n    return Addys(\n        hq = hq,\n        undyToken = staticcall UndyHq(hq).undyToken(),\n        ledger = staticcall UndyHq(hq).getAddr(LEDGER_ID),\n        missionControl = staticcall UndyHq(hq).getAddr(MISSION_CONTROL_ID),\n        legoBook = staticcall UndyHq(hq).getAddr(LEGO_BOOK_ID),\n        switchboard = staticcall UndyHq(hq).getAddr(SWITCHBOARD_ID),\n        hatchery = staticcall UndyHq(hq).getAddr(HATCHERY_ID),\n        lootDistributor = staticcall UndyHq(hq).getAddr(LOOT_DISTRIBUTOR_ID),\n        appraiser = staticcall UndyHq(hq).getAddr(APPRAISER_ID),\n        walletBackpack = staticcall UndyHq(hq).getAddr(WALLET_BACKPACK_ID),\n        billing = staticcall UndyHq(hq).getAddr(BILLING_ID),\n        vaultRegistry = staticcall UndyHq(hq).getAddr(VAULT_REGISTRY_ID),\n    )\n\n\n##########\n# Tokens #\n##########\n\n\n@view\n@internal\ndef _getUndyToken() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).undyToken()\n\n\n###########\n# Helpers #\n###########\n\n\n# undy hq\n\n\n@view\n@external\ndef getUndyHq() -> address:\n    return self._getUndyHq()\n\n\n@view\n@internal\ndef _getUndyHq() -> address:\n    return UNDY_HQ_FOR_ADDYS\n\n\n# utils\n\n\n@view\n@internal\ndef _isValidUndyAddr(_addr: address, _hq: address = empty(address)) -> bool:\n    hq: address = _hq\n    if _hq == empty(address):\n        hq = UNDY_HQ_FOR_ADDYS\n    \n    # core departments\n    if staticcall UndyHq(hq).isValidAddr(_addr):\n        return True\n\n    # lego book\n    legoBook: address = staticcall UndyHq(hq).getAddr(LEGO_BOOK_ID)\n    if legoBook != empty(address) and staticcall LegoBook(legoBook).isLegoAddr(_addr):\n        return True\n\n    # switchboard config\n    switchboard: address = staticcall UndyHq(hq).getAddr(SWITCHBOARD_ID)\n    if switchboard != empty(address) and staticcall Switchboard(switchboard).isSwitchboardAddr(_addr):\n        return True\n\n    return False\n\n\n@view\n@internal\ndef _isSwitchboardAddr(_addr: address) -> bool:\n    switchboard: address = staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(SWITCHBOARD_ID)\n    if switchboard == empty(address):\n        return False\n    return staticcall Switchboard(switchboard).isSwitchboardAddr(_addr)\n\n\n@view\n@internal\ndef _isLegoBookAddr(_addr: address) -> bool:\n    legoBook: address = staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEGO_BOOK_ID)\n    if legoBook == empty(address):\n        return False\n    return staticcall LegoBook(legoBook).isLegoAddr(_addr)\n\n\n###############\n# Departments #\n###############\n\n\n# ledger\n\n\n@view\n@internal\ndef _getLedgerId() -> uint256:\n    return LEDGER_ID\n\n\n@view\n@internal\ndef _getLedgerAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEDGER_ID)\n\n\n# mission control\n\n\n@view\n@internal\ndef _getMissionControlId() -> uint256:\n    return MISSION_CONTROL_ID\n\n\n@view\n@internal\ndef _getMissionControlAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(MISSION_CONTROL_ID)\n\n\n# lego book\n\n\n@view\n@internal\ndef _getLegoBookId() -> uint256:\n    return LEGO_BOOK_ID\n\n\n@view\n@internal\ndef _getLegoBookAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEGO_BOOK_ID)\n\n\n# switchboard\n\n\n@view\n@internal\ndef _getSwitchboardId() -> uint256:\n    return SWITCHBOARD_ID\n\n\n@view\n@internal\ndef _getSwitchboardAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(SWITCHBOARD_ID)\n\n\n# hatchery\n\n\n@view\n@internal\ndef _getHatcheryId() -> uint256:\n    return HATCHERY_ID\n\n\n@view\n@internal\ndef _getHatcheryAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(HATCHERY_ID)\n\n\n# loot distributor\n\n\n@view\n@internal\ndef _getLootDistributorId() -> uint256:\n    return LOOT_DISTRIBUTOR_ID\n\n\n@view\n@internal\ndef _getLootDistributorAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LOOT_DISTRIBUTOR_ID)\n\n\n# appraiser\n\n\n@view\n@internal\ndef _getAppraiserId() -> uint256:\n    return APPRAISER_ID\n\n\n@view\n@internal\ndef _getAppraiserAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(APPRAISER_ID)\n\n\n# wallet backpack\n\n\n@view\n@internal\ndef _getWalletBackpackId() -> uint256:\n    return WALLET_BACKPACK_ID\n\n\n@view\n@internal\ndef _getWalletBackpackAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(WALLET_BACKPACK_ID)\n\n\n# billing\n\n\n@view\n@internal\ndef _getBillingId() -> uint256:\n    return BILLING_ID\n\n\n@view\n@internal\ndef _getBillingAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(BILLING_ID)\n\n\n# vault registry\n\n\n@view\n@internal\ndef _getVaultRegistryId() -> uint256:\n    return VAULT_REGISTRY_ID\n\n\n@view\n@internal\ndef _getVaultRegistryAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(VAULT_REGISTRY_ID)\n\n\n# helpers\n\n\n@view\n@internal\ndef _getHelpersId() -> uint256:\n    return HELPERS_ID\n\n\n@view\n@internal\ndef _getHelpersAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(HELPERS_ID)",
            "sha256sum": "f550bb73a39fbf28fbeb23943f6c870a2f9a4263ded93b50950ed42ea0346155"
          },
          "contracts/helpers/LevgVaultTools.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\n#     \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n#     \u2551  ** LevgVaultTools (Frontend) **                      \u2551\n#     \u2551  Convenience functions for frontend / web app usage    \u2551\n#     \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\nexports: addys.__interface__\ninitializes: addys\nimport contracts.modules.Addys as addys\n\nfrom ethereum.ercs import IERC20\nfrom ethereum.ercs import IERC4626\n\ninterface LevgVault:\n    def vaultToLegoId(_vaultToken: address) -> uint256: view\n    def collateralAsset() -> RipeAsset: view\n    def leverageAsset() -> RipeAsset: view\n    def netUserCapital() -> uint256: view\n    def maxDebtRatio() -> uint256: view\n\ninterface RipeCreditEngine:\n    def getMaxBorrowAmount(_user: address) -> uint256: view\n    def getUserDebtAmount(_user: address) -> uint256: view\n    def getBorrowRate(_user: address) -> uint256: view\n\ninterface RipePriceDesk:\n    def getAssetAmount(_asset: address, _usdValue: uint256, _shouldRaise: bool = False) -> uint256: view\n    def getUsdValue(_asset: address, _amount: uint256, _shouldRaise: bool = False) -> uint256: view\n\ninterface YieldLego:\n    def getUnderlyingAmountSafe(_vaultToken: address, _vaultTokenBalance: uint256) -> uint256: view\n    def getUnderlyingAmount(_vaultToken: address, _vaultTokenAmount: uint256) -> uint256: view\n\ninterface RipeRegistry:\n    def savingsGreen() -> address: view\n    def greenToken() -> address: view\n\ninterface RipeDepositVault:\n    def getTotalAmountForUser(_user: address, _asset: address) -> uint256: view\n\ninterface RipeMissionControl:\n    def getFirstVaultIdForAsset(_asset: address) -> uint256: view\n\ninterface Ledger:\n    def vaultTokens(_vaultToken: address) -> VaultToken: view\n\ninterface Registry:\n    def getAddr(_regId: uint256) -> address: view\n\nstruct VaultToken:\n    legoId: uint256\n    underlyingAsset: address\n    decimals: uint256\n    isRebasing: bool\n\nstruct RipeAsset:\n    vaultToken: address\n    ripeVaultId: uint256\n\n# ripe addrs\nRIPE_REGISTRY: public(immutable(address))\nGREEN_TOKEN: public(immutable(address))\nSAVINGS_GREEN: public(immutable(address))\nUSDC: public(immutable(address))\n\nRIPE_MISSION_CONTROL_ID: constant(uint256) = 5\nRIPE_PRICE_DESK_ID: constant(uint256) = 7\nRIPE_VAULT_BOOK_ID: constant(uint256) = 8\nRIPE_CREDIT_ENGINE_ID: constant(uint256) = 13\nSTAB_POOL_ID: constant(uint256) = 1\n\nHUNDRED_PERCENT: constant(uint256) = 100_00  # 100.00%\n\n\n@deploy\ndef __init__(_undyHq: address, _ripeRegistry: address, _usdc: address):\n    addys.__init__(_undyHq)\n\n    assert _ripeRegistry != empty(address) # dev: invalid ripe registry\n    RIPE_REGISTRY = _ripeRegistry\n    GREEN_TOKEN = staticcall RipeRegistry(RIPE_REGISTRY).greenToken()\n    SAVINGS_GREEN = staticcall RipeRegistry(RIPE_REGISTRY).savingsGreen()\n\n    assert _usdc != empty(address) # dev: invalid usdc\n    USDC = _usdc\n\n\n####################\n# Total Underlying #\n####################\n\n\n@view\n@external\ndef getTotalUnderlyingAmount(\n    _levgVault: address,\n    _isCollateralAsset: bool,\n    _shouldGetMax: bool,\n    _legoBook: address = empty(address),\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> uint256:\n    vaultToken: address = empty(address)\n    ripeVaultId: uint256 = 0\n    vaultToken, ripeVaultId = self._getVaultTokenData(_levgVault, _isCollateralAsset)\n    if vaultToken == empty(address):\n        return 0\n\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n\n    return self._getTotalUnderlyingAmount(_levgVault, vaultToken, _isCollateralAsset, _shouldGetMax, ripeVaultId, legoBook, ripeVaultBook, ripeMissionControl)\n\n\n@view\n@internal\ndef _getTotalUnderlyingAmount(\n    _levgVault: address,\n    _vaultToken: address,\n    _isCollateralAsset: bool,\n    _shouldGetMax: bool,\n    _ripeVaultId: uint256,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    underlyingAsset: address = staticcall IERC4626(_levgVault).asset() if _isCollateralAsset else USDC\n    underlyingNaked: uint256 = self._getAmountForAsset(_levgVault, underlyingAsset, 0, _ripeVaultBook, _ripeMissionControl)\n    underlyingFromVault: uint256 = self._getUnderlyingAmountForVaultToken(_levgVault, _vaultToken, _shouldGetMax, _ripeVaultId, _legoBook, _ripeVaultBook, _ripeMissionControl)\n    return underlyingNaked + underlyingFromVault\n\n\n####################\n# Amount for Asset #\n####################\n\n\n@view\n@external\ndef getAmountForAsset(\n    _levgVault: address,\n    _asset: address,\n    _ripeVaultId: uint256 = 0,\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> uint256:\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n    return self._getAmountForAsset(_levgVault, _asset, _ripeVaultId, ripeVaultBook, ripeMissionControl)\n\n\n@view\n@internal\ndef _getAmountForAsset(\n    _levgVault: address,\n    _asset: address,\n    _ripeVaultId: uint256,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    if _asset == empty(address):\n        return 0\n\n    # asset in wallet\n    amount: uint256 = staticcall IERC20(_asset).balanceOf(_levgVault)\n\n    # asset on Ripe\n    amount += self._getRipeCollateralBalance(_levgVault, _asset, _ripeVaultId, _ripeVaultBook, _ripeMissionControl)\n\n    return amount\n\n\n###############################\n# Underlying from Vault Token #\n###############################\n\n\n@view\n@external\ndef getUnderlyingAmountForVaultToken(\n    _levgVault: address,\n    _isCollateralAsset: bool,\n    _shouldGetMax: bool,\n    _legoBook: address = empty(address),\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> uint256:\n    vaultToken: address = empty(address)\n    ripeVaultId: uint256 = 0\n    vaultToken, ripeVaultId = self._getVaultTokenData(_levgVault, _isCollateralAsset)\n    if vaultToken == empty(address):\n        return 0\n\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n\n    return self._getUnderlyingAmountForVaultToken(_levgVault, vaultToken, _shouldGetMax, ripeVaultId, legoBook, ripeVaultBook, ripeMissionControl)\n\n\n@view\n@internal\ndef _getUnderlyingAmountForVaultToken(\n    _levgVault: address,\n    _vaultToken: address,\n    _shouldGetMax: bool,\n    _ripeVaultId: uint256,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    if _vaultToken == empty(address):\n        return 0\n\n    # get vault token amount (in wallet and on ripe)\n    vaultTokenAmount: uint256 = self._getAmountForAsset(_levgVault, _vaultToken, _ripeVaultId, _ripeVaultBook, _ripeMissionControl)\n    if vaultTokenAmount == 0:\n        return 0\n\n    # get underlying amount with vault token amount\n    return self._getUnderlyingAmountWithVaultTokenAmount(_levgVault, _vaultToken, vaultTokenAmount, _shouldGetMax, 0, _legoBook)\n\n\n@view\n@internal\ndef _getUnderlyingAmountWithVaultTokenAmount(\n    _levgVault: address,\n    _vaultToken: address,\n    _vaultTokenAmount: uint256,\n    _shouldGetMax: bool,\n    _undyVaultTokenLegoId: uint256,\n    _legoBook: address,\n) -> uint256:\n    # get lego id (if necessary)\n    legoId: uint256 = self._getLegoIdForVaultToken(_levgVault, _vaultToken, _undyVaultTokenLegoId)\n    if legoId == 0:\n        return 0\n\n    # underscore lego address\n    legoAddr: address = staticcall Registry(_legoBook).getAddr(legoId)\n    if legoAddr == empty(address):\n        return 0\n\n    # calc underlying amount\n    underlyingAmount: uint256 = 0\n    if _shouldGetMax:\n        underlyingAmount = staticcall YieldLego(legoAddr).getUnderlyingAmount(_vaultToken, _vaultTokenAmount)\n    else:\n        underlyingAmount = staticcall YieldLego(legoAddr).getUnderlyingAmountSafe(_vaultToken, _vaultTokenAmount)\n\n    return underlyingAmount\n\n\n###################\n# Ripe Collateral #\n###################\n\n\n@view\n@external\ndef getRipeCollateralBalance(\n    _levgVault: address,\n    _asset: address,\n    _ripeVaultId: uint256 = 0,\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> uint256:\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n    return self._getRipeCollateralBalance(_levgVault, _asset, _ripeVaultId, ripeVaultBook, ripeMissionControl)\n\n\n@view\n@internal\ndef _getRipeCollateralBalance(\n    _levgVault: address,\n    _asset: address,\n    _ripeVaultId: uint256,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    ripeVaultId: uint256 = _ripeVaultId\n\n    # get ripe vault id (if necessary)\n    if ripeVaultId == 0:\n        ripeVaultId = staticcall RipeMissionControl(_ripeMissionControl).getFirstVaultIdForAsset(_asset)\n\n    # no ripe vault id found\n    if ripeVaultId == 0:\n        return 0\n\n    # get ripe vault deposit address\n    ripeVaultAddr: address = staticcall Registry(_ripeVaultBook).getAddr(ripeVaultId)\n    if ripeVaultAddr == empty(address):\n        return 0\n\n    # get total amount for user\n    return staticcall RipeDepositVault(ripeVaultAddr).getTotalAmountForUser(_levgVault, _asset)\n\n\n#################\n# GREEN Helpers #\n#################\n\n\n@view\n@external\ndef getUnderlyingGreenAmount(\n    _levgVault: address,\n    _green: address = empty(address),\n    _savingsGreen: address = empty(address),\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> uint256:\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n    return self._getUnderlyingGreenAmount(_levgVault, _green, _savingsGreen, ripeVaultBook, ripeMissionControl)\n\n\n@view\n@internal\ndef _getUnderlyingGreenAmount(\n    _levgVault: address,\n    _green: address,\n    _savingsGreen: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    green: address = _green if _green != empty(address) else GREEN_TOKEN\n    greenAmount: uint256 = staticcall IERC20(green).balanceOf(_levgVault)\n\n    # savings green balance (in wallet and on ripe)\n    savingsGreen: address = _savingsGreen if _savingsGreen != empty(address) else SAVINGS_GREEN\n    savingsGreenAmount: uint256 = self._getAmountForAsset(_levgVault, savingsGreen, STAB_POOL_ID, _ripeVaultBook, _ripeMissionControl)\n\n    # calc underlying amount\n    if savingsGreenAmount != 0:\n        greenAmount += staticcall IERC4626(savingsGreen).previewRedeem(savingsGreenAmount)\n\n    return greenAmount\n\n\n################\n# Swap Helpers #\n################\n\n\n@view\n@external\ndef getSwappableUsdcAmount(\n    _levgVault: address,\n    _leverageVaultToken: address = empty(address),\n    _leverageVaultTokenRipeVaultId: uint256 = 0,\n    _usdc: address = empty(address),\n    _green: address = empty(address),\n    _savingsGreen: address = empty(address),\n    _legoBook: address = empty(address),\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> uint256:\n    # resolve addresses\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n    ripePriceDesk: address = self._getRipePriceDesk(empty(address), ripeHq)\n\n    return self._getSwappableUsdcAmount(_levgVault, _leverageVaultToken, _leverageVaultTokenRipeVaultId, _usdc, _green, _savingsGreen, legoBook, ripeVaultBook, ripeMissionControl, creditEngine, ripePriceDesk)\n\n\n@view\n@internal\ndef _getSwappableUsdcAmount(\n    _levgVault: address,\n    _leverageVaultToken: address,\n    _leverageVaultTokenRipeVaultId: uint256,\n    _usdc: address,\n    _green: address,\n    _savingsGreen: address,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n    _creditEngine: address,\n    _ripePriceDesk: address,\n) -> uint256:\n    usdc: address = _usdc if _usdc != empty(address) else USDC\n\n    # core underlying asset must be different from USDC\n    if staticcall IERC4626(_levgVault).asset() == usdc:\n        return 0\n\n    # get leverage vault token data (if necessary)\n    leverageVaultToken: address = _leverageVaultToken\n    leverageVaultTokenRipeVaultId: uint256 = _leverageVaultTokenRipeVaultId\n    if leverageVaultToken == empty(address) or leverageVaultTokenRipeVaultId == 0:\n        levgData: RipeAsset = staticcall LevgVault(_levgVault).leverageAsset()\n        leverageVaultToken = levgData.vaultToken\n        leverageVaultTokenRipeVaultId = levgData.ripeVaultId\n\n    # leverage vault token must be USDC\n    if staticcall IERC4626(leverageVaultToken).asset() != usdc:\n        return 0\n\n    # total usdc amount (in wallet, naked on ripe, via vault token)\n    usdcAmount: uint256 = self._getTotalUnderlyingAmount(_levgVault, leverageVaultToken, False, False, leverageVaultTokenRipeVaultId, _legoBook, _ripeVaultBook, _ripeMissionControl)\n\n    # user debt amount\n    userDebtAmount: uint256 = staticcall RipeCreditEngine(_creditEngine).getUserDebtAmount(_levgVault) # 18 decimals\n    if userDebtAmount == 0:\n        return usdcAmount\n\n    # convert to USD value\n    usdcValue: uint256 = staticcall RipePriceDesk(_ripePriceDesk).getUsdValue(usdc, usdcAmount, False) # 18 decimals\n\n    # green amount (treat as $1 USD to offset debt)\n    greenSurplusAmount: uint256 = self._getUnderlyingGreenAmount(_levgVault, _green, _savingsGreen, _ripeVaultBook, _ripeMissionControl)\n\n    # if GREEN covers all debt, all USDC is swappable\n    if greenSurplusAmount >= userDebtAmount:\n        return usdcAmount\n\n    # remaining debt must come from USDC\n    remainingDebt: uint256 = userDebtAmount - greenSurplusAmount\n    if remainingDebt >= usdcValue:\n        return 0\n\n    return staticcall RipePriceDesk(_ripePriceDesk).getAssetAmount(usdc, usdcValue - remainingDebt, True)\n\n\n##################\n# Borrow Helpers #\n##################\n\n\n@view\n@external\ndef getBorrowRate(_levgVault: address, _ripeHq: address = empty(address)) -> uint256:\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n    return staticcall RipeCreditEngine(creditEngine).getBorrowRate(_levgVault)\n\n\n@view\n@external\ndef getDebtAmount(_levgVault: address, _ripeHq: address = empty(address)) -> uint256:\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n    return staticcall RipeCreditEngine(creditEngine).getUserDebtAmount(_levgVault)\n\n\n# true max borrow amount\n\n\n@view\n@external\ndef getTrueMaxBorrowAmount(_levgVault: address, _ripeHq: address = empty(address)) -> uint256:\n    # resolve addresses\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(empty(address), ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(empty(address), ripeHq)\n    legoBook: address = addys._getLegoBookAddr()\n    ripePriceDesk: address = self._getRipePriceDesk(empty(address), ripeHq)\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n\n    maxDebtRatioLimit: uint256 = self._getMaxBorrowAmountByMaxDebtRatio(_levgVault, empty(address), empty(address), 0, empty(address), 0, 0, legoBook, ripeVaultBook, ripeMissionControl, ripePriceDesk, creditEngine)\n    maxBorrowAmount: uint256 = self._getMaxBorrowAmountByRipeLtv(_levgVault, creditEngine)\n    return min(maxDebtRatioLimit, maxBorrowAmount)\n\n\n# Max Debt Ratio\n\n\n@view\n@external\ndef getMaxBorrowAmountByMaxDebtRatio(\n    _levgVault: address,\n    _underlyingAsset: address = empty(address),\n    _collateralVaultToken: address = empty(address),\n    _collateralVaultTokenRipeVaultId: uint256 = 0,\n    _leverageVaultToken: address = empty(address),\n    _netUserCapital: uint256 = 0,\n    _maxDebtRatio: uint256 = 0,\n    _legoBook: address = empty(address),\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> uint256:\n    # resolve addresses\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n    ripePriceDesk: address = self._getRipePriceDesk(empty(address), ripeHq)\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n\n    return self._getMaxBorrowAmountByMaxDebtRatio(_levgVault, _underlyingAsset, _collateralVaultToken, _collateralVaultTokenRipeVaultId, _leverageVaultToken, _netUserCapital, _maxDebtRatio, legoBook, ripeVaultBook, ripeMissionControl, ripePriceDesk, creditEngine)\n\n\n@view\n@internal\ndef _getMaxBorrowAmountByMaxDebtRatio(\n    _levgVault: address,\n    _underlyingAsset: address,\n    _collateralVaultToken: address,\n    _collateralVaultTokenRipeVaultId: uint256,\n    _leverageVaultToken: address,\n    _netUserCapital: uint256,\n    _maxDebtRatio: uint256,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n    _ripePriceDesk: address,\n    _creditEngine: address,\n) -> uint256:\n    # get max debt ratio (if necessary) -- check early to avoid expensive calculations\n    maxDebtRatio: uint256 = _maxDebtRatio if _maxDebtRatio != 0 else staticcall LevgVault(_levgVault).maxDebtRatio()\n    if maxDebtRatio == 0:\n        return max_value(uint256)\n\n    # get leverage vault token (if necessary)\n    leverageVaultToken: address = _leverageVaultToken\n    if leverageVaultToken == empty(address):\n        levgData: RipeAsset = staticcall LevgVault(_levgVault).leverageAsset()\n        leverageVaultToken = levgData.vaultToken\n\n    collateralVaultToken: address = _collateralVaultToken\n    collateralVaultTokenRipeVaultId: uint256 = _collateralVaultTokenRipeVaultId\n    if collateralVaultToken == empty(address) or collateralVaultTokenRipeVaultId == 0:\n        levgData: RipeAsset = staticcall LevgVault(_levgVault).collateralAsset()\n        collateralVaultToken = levgData.vaultToken\n        collateralVaultTokenRipeVaultId = levgData.ripeVaultId\n\n    # for usdc leverage vaults, use netUserCapital only (otherwise can't distinguish user capital from leveraged positions)\n    underlyingAmount: uint256 = 0\n    if collateralVaultToken == leverageVaultToken:\n        underlyingAmount = _netUserCapital if _netUserCapital != 0 else staticcall LevgVault(_levgVault).netUserCapital()\n\n    # typical leverage vault\n    else:\n        underlyingAmount = self._getTotalUnderlyingAmount(\n            _levgVault,\n            collateralVaultToken,\n            True, # is collateral asset\n            False, # conservative, safe underlying amount\n            collateralVaultTokenRipeVaultId,\n            _legoBook,\n            _ripeVaultBook,\n            _ripeMissionControl,\n        )\n\n    # get underlying asset (if necessary)\n    underlyingAsset: address = _underlyingAsset if _underlyingAsset != empty(address) else staticcall IERC4626(_levgVault).asset()\n\n    # convert to USD value\n    underlyingUsdValue: uint256 = staticcall RipePriceDesk(_ripePriceDesk).getUsdValue(underlyingAsset, underlyingAmount, True)\n\n    # current debt amount (in GREEN, 18 decimals, treated as $1 USD)\n    currentDebt: uint256 = staticcall RipeCreditEngine(_creditEngine).getUserDebtAmount(_levgVault)\n\n    # user's GREEN can offset debt (GREEN is 18 decimals, treated as $1 USD)\n    greenAmount: uint256 = self._getUnderlyingGreenAmount(_levgVault, empty(address), empty(address), _ripeVaultBook, _ripeMissionControl)\n    remainingDebt: uint256 = 0\n    if currentDebt > greenAmount:\n        remainingDebt = currentDebt - greenAmount\n\n    # max allowed debt (in USD)\n    maxAllowedDebt: uint256 = underlyingUsdValue * maxDebtRatio // HUNDRED_PERCENT\n    if remainingDebt >= maxAllowedDebt:\n        return 0\n\n    return maxAllowedDebt - remainingDebt\n\n\n# Ripe LTV\n\n\n@view\n@external\ndef getMaxBorrowAmountByRipeLtv(\n    _levgVault: address,\n    _creditEngine: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> uint256:\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    creditEngine: address = self._getRipeCreditEngine(_creditEngine, ripeHq)\n    return self._getMaxBorrowAmountByRipeLtv(_levgVault, creditEngine)\n\n\n@view\n@internal\ndef _getMaxBorrowAmountByRipeLtv(\n    _levgVault: address,\n    _creditEngine: address,\n) -> uint256:\n    return staticcall RipeCreditEngine(_creditEngine).getMaxBorrowAmount(_levgVault)\n\n\n################\n# Combinations #\n################\n\n\n# vault token amounts\n\n\n@view\n@external\ndef getVaultTokenAmounts(\n    _levgVault: address,\n    _isCollateralAsset: bool,\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> (uint256, uint256):\n    vaultToken: address = empty(address)\n    ripeVaultId: uint256 = 0\n    vaultToken, ripeVaultId = self._getVaultTokenData(_levgVault, _isCollateralAsset)\n    if vaultToken == empty(address) or ripeVaultId == 0:\n        return 0, 0\n\n    # resolve ripe addresses\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n\n    # 1. vault token in wallet\n    vaultTokenInWallet: uint256 = staticcall IERC20(vaultToken).balanceOf(_levgVault)\n\n    # 2. vault token in Ripe\n    vaultTokenInRipe: uint256 = self._getRipeCollateralBalance(_levgVault, vaultToken, ripeVaultId, ripeVaultBook, ripeMissionControl)\n\n    return vaultTokenInWallet, vaultTokenInRipe\n\n\n# underlying amounts\n\n\n@view\n@external\ndef getUnderlyingAmounts(\n    _levgVault: address,\n    _isCollateralAsset: bool,\n    _shouldGetMax: bool,\n    _legoBook: address = empty(address),\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> (uint256, uint256, uint256, uint256):\n    vaultToken: address = empty(address)\n    ripeVaultId: uint256 = 0\n    vaultToken, ripeVaultId = self._getVaultTokenData(_levgVault, _isCollateralAsset)\n    if vaultToken == empty(address) or ripeVaultId == 0:\n        return 0, 0, 0, 0\n\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n\n    return self._getUnderlyingAmounts(_levgVault, vaultToken, ripeVaultId, _shouldGetMax, legoBook, ripeVaultBook, ripeMissionControl)\n\n\n@view\n@internal\ndef _getUnderlyingAmounts(\n    _levgVault: address,\n    _vaultToken: address,\n    _ripeVaultId: uint256,\n    _shouldGetMax: bool,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> (uint256, uint256, uint256, uint256):\n    if _vaultToken == empty(address) or _ripeVaultId == 0:\n        return 0, 0, 0, 0\n\n    # 1. underlying asset in wallet\n    underlyingAsset: address = staticcall IERC4626(_levgVault).asset()\n    underlyingInWallet: uint256 = staticcall IERC20(underlyingAsset).balanceOf(_levgVault)\n\n    # 2. vault token in wallet -> converted to underlying via lego\n    vaultTokenInWallet: uint256 = staticcall IERC20(_vaultToken).balanceOf(_levgVault)\n    vaultTokenInWalletConverted: uint256 = self._getUnderlyingAmountWithVaultTokenAmount(_levgVault, _vaultToken, vaultTokenInWallet, _shouldGetMax, 0, _legoBook)\n\n    # 3. underlying asset deposited in Ripe Protocol (raw)\n    underlyingInRipe: uint256 = self._getRipeCollateralBalance(_levgVault, underlyingAsset, 0, _ripeVaultBook, _ripeMissionControl)\n\n    # 4. vault token in Ripe -> converted to underlying via lego\n    vaultTokenInRipe: uint256 = self._getRipeCollateralBalance(_levgVault, _vaultToken, _ripeVaultId, _ripeVaultBook, _ripeMissionControl)\n    vaultTokenInRipeConverted: uint256 = self._getUnderlyingAmountWithVaultTokenAmount(_levgVault, _vaultToken, vaultTokenInRipe, _shouldGetMax, 0, _legoBook)\n\n    return underlyingInWallet, vaultTokenInWalletConverted, underlyingInRipe, vaultTokenInRipeConverted\n\n\n# green amounts\n\n\n@view\n@external\ndef getGreenAmounts(\n    _levgVault: address,\n    _green: address = empty(address),\n    _savingsGreen: address = empty(address),\n    _ripeVaultBook: address = empty(address),\n    _ripeMissionControl: address = empty(address),\n    _ripeHq: address = empty(address),\n) -> (uint256, uint256, uint256, uint256):\n    # resolve ripe addresses\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    ripeVaultBook: address = self._getRipeVaultBook(_ripeVaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(_ripeMissionControl, ripeHq)\n\n    # 1. user debt in Ripe Protocol (denominated in GREEN)\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n    userDebt: uint256 = staticcall RipeCreditEngine(creditEngine).getUserDebtAmount(_levgVault)\n\n    # 2. GREEN in wallet\n    green: address = _green if _green != empty(address) else GREEN_TOKEN\n    greenInWallet: uint256 = staticcall IERC20(green).balanceOf(_levgVault)\n\n    # 3. sGREEN in wallet -> converted to GREEN\n    savingsGreen: address = _savingsGreen if _savingsGreen != empty(address) else SAVINGS_GREEN\n    sGreenInWalletConverted: uint256 = 0\n    sGreenInWallet: uint256 = staticcall IERC20(savingsGreen).balanceOf(_levgVault)\n    if sGreenInWallet != 0:\n        sGreenInWalletConverted = staticcall IERC4626(savingsGreen).previewRedeem(sGreenInWallet)\n\n    # 4. sGREEN in Ripe -> converted to GREEN\n    sGreenInRipeConverted: uint256 = 0\n    sGreenInRipe: uint256 = self._getRipeCollateralBalance(_levgVault, savingsGreen, STAB_POOL_ID, ripeVaultBook, ripeMissionControl)\n    if sGreenInRipe != 0:\n        sGreenInRipeConverted = staticcall IERC4626(savingsGreen).previewRedeem(sGreenInRipe)\n\n    return userDebt, greenInWallet, sGreenInWalletConverted, sGreenInRipeConverted\n\n\n#############\n# Utilities #\n#############\n\n\n# get lego id\n\n\n@view\n@internal\ndef _getLegoIdForVaultToken(_levgVault: address, _vaultToken: address, _undyVaultTokenLegoId: uint256 = 0) -> uint256:\n    if _undyVaultTokenLegoId != 0:\n        return _undyVaultTokenLegoId\n\n    legoId: uint256 = staticcall LevgVault(_levgVault).vaultToLegoId(_vaultToken)\n    if legoId != 0:\n        return legoId\n\n    data: VaultToken = staticcall Ledger(addys._getLedgerAddr()).vaultTokens(_vaultToken)\n    return data.legoId\n\n\n# get vault token data\n\n\n@view\n@internal\ndef _getVaultTokenData(_levgVault: address, _isCollateralAsset: bool) -> (address, uint256):\n    assetData: RipeAsset = empty(RipeAsset)\n    if _isCollateralAsset:\n        assetData = staticcall LevgVault(_levgVault).collateralAsset()\n    else:\n        assetData = staticcall LevgVault(_levgVault).leverageAsset()\n    return assetData.vaultToken, assetData.ripeVaultId\n\n\n# ripe addrs\n\n\n@view\n@internal\ndef _getRipeVaultBook(_ripeVaultBook: address = empty(address), _ripeHq: address = empty(address)) -> address:\n    if _ripeVaultBook != empty(address):\n        return _ripeVaultBook\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    return staticcall Registry(ripeHq).getAddr(RIPE_VAULT_BOOK_ID)\n\n\n@view\n@internal\ndef _getRipeMissionControl(_ripeMissionControl: address = empty(address), _ripeHq: address = empty(address)) -> address:\n    if _ripeMissionControl != empty(address):\n        return _ripeMissionControl\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    return staticcall Registry(ripeHq).getAddr(RIPE_MISSION_CONTROL_ID)\n\n\n@view\n@internal\ndef _getRipeCreditEngine(_ripeCreditEngine: address = empty(address), _ripeHq: address = empty(address)) -> address:\n    if _ripeCreditEngine != empty(address):\n        return _ripeCreditEngine\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    return staticcall Registry(ripeHq).getAddr(RIPE_CREDIT_ENGINE_ID)\n\n\n@view\n@internal\ndef _getRipePriceDesk(_ripePriceDesk: address = empty(address), _ripeHq: address = empty(address)) -> address:\n    if _ripePriceDesk != empty(address):\n        return _ripePriceDesk\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    return staticcall Registry(ripeHq).getAddr(RIPE_PRICE_DESK_ID)\n\n\n@view\n@internal\ndef _getRipeHq(_ripeHq: address = empty(address)) -> address:\n    if _ripeHq != empty(address):\n        return _ripeHq\n    return RIPE_REGISTRY\n",
            "sha256sum": "5f11c6cb7016e711ba513abc310afded2f192c708e7942ca40a58accc995a725"
          }
        },
        "settings": {
          "outputSelection": {
            "contracts/helpers/LevgVaultTools.vy": [
              "*"
            ]
          },
          "search_paths": [
            "."
          ]
        },
        "compiler_version": "v0.4.3+commit.bff19ea2",
        "integrity": "cc020cbc1c35236e23e8ef357ec13fd276e9b54468d1ec6680a1a89c67a11a67"
      },
      "args": "00000000000000000000000044cf3c4f000dfd76a35d03298049d37be688d6f90000000000000000000000006162df1b329e157479f8f1407e888260e0ec3d2b000000000000000000000000833589fcd6edb6e08f4c7c32d4f71b54bda02913",
      "file": "contracts/helpers/LevgVaultTools.vy"
    },
    "LevgVaultHelper": {
      "address": "0x19e0c1d2272545De38C6D2A3dF3476E4b9e48328",
      "abi": [
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getAddys",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "tuple",
              "components": [
                {
                  "name": "hq",
                  "type": "address"
                },
                {
                  "name": "undyToken",
                  "type": "address"
                },
                {
                  "name": "ledger",
                  "type": "address"
                },
                {
                  "name": "missionControl",
                  "type": "address"
                },
                {
                  "name": "legoBook",
                  "type": "address"
                },
                {
                  "name": "switchboard",
                  "type": "address"
                },
                {
                  "name": "hatchery",
                  "type": "address"
                },
                {
                  "name": "lootDistributor",
                  "type": "address"
                },
                {
                  "name": "appraiser",
                  "type": "address"
                },
                {
                  "name": "walletBackpack",
                  "type": "address"
                },
                {
                  "name": "billing",
                  "type": "address"
                },
                {
                  "name": "vaultRegistry",
                  "type": "address"
                }
              ]
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getUndyHq",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_amountIn",
              "type": "uint256"
            },
            {
              "name": "_currentBalance",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_amountIn",
              "type": "uint256"
            },
            {
              "name": "_currentBalance",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_amountIn",
              "type": "uint256"
            },
            {
              "name": "_currentBalance",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_amountIn",
              "type": "uint256"
            },
            {
              "name": "_currentBalance",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getSwappableUsdcAmount",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_amountIn",
              "type": "uint256"
            },
            {
              "name": "_currentBalance",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmount",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_netUserCapital",
              "type": "uint256"
            },
            {
              "name": "_maxDebtRatio",
              "type": "uint256"
            },
            {
              "name": "_isUsdcVault",
              "type": "bool"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getMaxBorrowAmount",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_netUserCapital",
              "type": "uint256"
            },
            {
              "name": "_maxDebtRatio",
              "type": "uint256"
            },
            {
              "name": "_isUsdcVault",
              "type": "bool"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "performPostSwapValidation",
          "inputs": [
            {
              "name": "_tokenIn",
              "type": "address"
            },
            {
              "name": "_tokenInAmount",
              "type": "uint256"
            },
            {
              "name": "_tokenOut",
              "type": "address"
            },
            {
              "name": "_tokenOutAmount",
              "type": "uint256"
            },
            {
              "name": "_usdcSlippageAllowed",
              "type": "uint256"
            },
            {
              "name": "_greenSlippageAllowed",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "performPostSwapValidation",
          "inputs": [
            {
              "name": "_tokenIn",
              "type": "address"
            },
            {
              "name": "_tokenInAmount",
              "type": "uint256"
            },
            {
              "name": "_tokenOut",
              "type": "address"
            },
            {
              "name": "_tokenOutAmount",
              "type": "uint256"
            },
            {
              "name": "_usdcSlippageAllowed",
              "type": "uint256"
            },
            {
              "name": "_greenSlippageAllowed",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "performPostSwapValidation",
          "inputs": [
            {
              "name": "_tokenIn",
              "type": "address"
            },
            {
              "name": "_tokenInAmount",
              "type": "uint256"
            },
            {
              "name": "_tokenOut",
              "type": "address"
            },
            {
              "name": "_tokenOutAmount",
              "type": "uint256"
            },
            {
              "name": "_usdcSlippageAllowed",
              "type": "uint256"
            },
            {
              "name": "_greenSlippageAllowed",
              "type": "uint256"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_usdc",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForNonUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForNonUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForNonUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_usdc",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForNonUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForNonUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getTotalAssetsForNonUsdcVault",
          "inputs": [
            {
              "name": "_wallet",
              "type": "address"
            },
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_collateralVaultToken",
              "type": "address"
            },
            {
              "name": "_collateralVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_collateralVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultToken",
              "type": "address"
            },
            {
              "name": "_leverageVaultTokenLegoId",
              "type": "uint256"
            },
            {
              "name": "_leverageVaultTokenRipeVaultId",
              "type": "uint256"
            },
            {
              "name": "_shouldGetMax",
              "type": "bool"
            },
            {
              "name": "_usdc",
              "type": "address"
            },
            {
              "name": "_green",
              "type": "address"
            },
            {
              "name": "_savingsGreen",
              "type": "address"
            },
            {
              "name": "_legoBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getCollateralBalance",
          "inputs": [
            {
              "name": "_user",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getCollateralBalance",
          "inputs": [
            {
              "name": "_user",
              "type": "address"
            },
            {
              "name": "_asset",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            },
            {
              "name": "_vaultBook",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "uint256"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isSupportedAssetInVault",
          "inputs": [
            {
              "name": "_vaultId",
              "type": "uint256"
            },
            {
              "name": "_asset",
              "type": "address"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "getVaultBookAndDeleverage",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            },
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "isValidVaultToken",
          "inputs": [
            {
              "name": "_underlyingAsset",
              "type": "address"
            },
            {
              "name": "_vaultToken",
              "type": "address"
            },
            {
              "name": "_ripeVaultId",
              "type": "uint256"
            },
            {
              "name": "_legoId",
              "type": "uint256"
            }
          ],
          "outputs": [
            {
              "name": "",
              "type": "bool"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "RIPE_REGISTRY",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "GREEN_TOKEN",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "SAVINGS_GREEN",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "view",
          "type": "function",
          "name": "USDC",
          "inputs": [],
          "outputs": [
            {
              "name": "",
              "type": "address"
            }
          ]
        },
        {
          "stateMutability": "nonpayable",
          "type": "constructor",
          "inputs": [
            {
              "name": "_undyHq",
              "type": "address"
            },
            {
              "name": "_ripeRegistry",
              "type": "address"
            },
            {
              "name": "_usdc",
              "type": "address"
            }
          ],
          "outputs": []
        }
      ],
      "solc_json": {
        "language": "Vyper",
        "sources": {
          "contracts/modules/Addys.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\ninterface UndyHq:\n    def isValidAddr(_addr: address) -> bool: view\n    def getAddr(_regId: uint256) -> address: view\n    def undyToken() -> address: view\n\ninterface Switchboard:\n    def isSwitchboardAddr(_addr: address) -> bool: view\n\ninterface LegoBook:\n    def isLegoAddr(_addr: address) -> bool: view\n\nstruct Addys:\n    hq: address\n    undyToken: address\n    ledger: address\n    missionControl: address\n    legoBook: address\n    switchboard: address\n    hatchery: address\n    lootDistributor: address\n    appraiser: address\n    walletBackpack: address\n    billing: address\n    vaultRegistry: address\n\n# hq\nUNDY_HQ_FOR_ADDYS: immutable(address)\n\n# core addys\nLEDGER_ID: constant(uint256) = 1\nMISSION_CONTROL_ID: constant(uint256) = 2\nLEGO_BOOK_ID: constant(uint256) = 3\nSWITCHBOARD_ID: constant(uint256) = 4\nHATCHERY_ID: constant(uint256) = 5\nLOOT_DISTRIBUTOR_ID: constant(uint256) = 6\nAPPRAISER_ID: constant(uint256) = 7\nWALLET_BACKPACK_ID: constant(uint256) = 8\nBILLING_ID: constant(uint256) = 9\nVAULT_REGISTRY_ID: constant(uint256) = 10\nHELPERS_ID: constant(uint256) = 11\n\n\n@deploy\ndef __init__(_undyHq: address):\n    assert _undyHq != empty(address) # dev: invalid undy hq\n    UNDY_HQ_FOR_ADDYS = _undyHq\n\n\n########\n# Core #\n########\n\n\n@view\n@external\ndef getAddys() -> Addys:\n    return self._generateAddys()\n\n\n@view\n@internal\ndef _getAddys(_addys: Addys = empty(Addys)) -> Addys:\n    if _addys.hq != empty(address):\n        return _addys\n    return self._generateAddys()\n\n\n@view\n@internal\ndef _generateAddys() -> Addys:\n    hq: address = UNDY_HQ_FOR_ADDYS\n    return Addys(\n        hq = hq,\n        undyToken = staticcall UndyHq(hq).undyToken(),\n        ledger = staticcall UndyHq(hq).getAddr(LEDGER_ID),\n        missionControl = staticcall UndyHq(hq).getAddr(MISSION_CONTROL_ID),\n        legoBook = staticcall UndyHq(hq).getAddr(LEGO_BOOK_ID),\n        switchboard = staticcall UndyHq(hq).getAddr(SWITCHBOARD_ID),\n        hatchery = staticcall UndyHq(hq).getAddr(HATCHERY_ID),\n        lootDistributor = staticcall UndyHq(hq).getAddr(LOOT_DISTRIBUTOR_ID),\n        appraiser = staticcall UndyHq(hq).getAddr(APPRAISER_ID),\n        walletBackpack = staticcall UndyHq(hq).getAddr(WALLET_BACKPACK_ID),\n        billing = staticcall UndyHq(hq).getAddr(BILLING_ID),\n        vaultRegistry = staticcall UndyHq(hq).getAddr(VAULT_REGISTRY_ID),\n    )\n\n\n##########\n# Tokens #\n##########\n\n\n@view\n@internal\ndef _getUndyToken() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).undyToken()\n\n\n###########\n# Helpers #\n###########\n\n\n# undy hq\n\n\n@view\n@external\ndef getUndyHq() -> address:\n    return self._getUndyHq()\n\n\n@view\n@internal\ndef _getUndyHq() -> address:\n    return UNDY_HQ_FOR_ADDYS\n\n\n# utils\n\n\n@view\n@internal\ndef _isValidUndyAddr(_addr: address, _hq: address = empty(address)) -> bool:\n    hq: address = _hq\n    if _hq == empty(address):\n        hq = UNDY_HQ_FOR_ADDYS\n    \n    # core departments\n    if staticcall UndyHq(hq).isValidAddr(_addr):\n        return True\n\n    # lego book\n    legoBook: address = staticcall UndyHq(hq).getAddr(LEGO_BOOK_ID)\n    if legoBook != empty(address) and staticcall LegoBook(legoBook).isLegoAddr(_addr):\n        return True\n\n    # switchboard config\n    switchboard: address = staticcall UndyHq(hq).getAddr(SWITCHBOARD_ID)\n    if switchboard != empty(address) and staticcall Switchboard(switchboard).isSwitchboardAddr(_addr):\n        return True\n\n    return False\n\n\n@view\n@internal\ndef _isSwitchboardAddr(_addr: address) -> bool:\n    switchboard: address = staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(SWITCHBOARD_ID)\n    if switchboard == empty(address):\n        return False\n    return staticcall Switchboard(switchboard).isSwitchboardAddr(_addr)\n\n\n@view\n@internal\ndef _isLegoBookAddr(_addr: address) -> bool:\n    legoBook: address = staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEGO_BOOK_ID)\n    if legoBook == empty(address):\n        return False\n    return staticcall LegoBook(legoBook).isLegoAddr(_addr)\n\n\n###############\n# Departments #\n###############\n\n\n# ledger\n\n\n@view\n@internal\ndef _getLedgerId() -> uint256:\n    return LEDGER_ID\n\n\n@view\n@internal\ndef _getLedgerAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEDGER_ID)\n\n\n# mission control\n\n\n@view\n@internal\ndef _getMissionControlId() -> uint256:\n    return MISSION_CONTROL_ID\n\n\n@view\n@internal\ndef _getMissionControlAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(MISSION_CONTROL_ID)\n\n\n# lego book\n\n\n@view\n@internal\ndef _getLegoBookId() -> uint256:\n    return LEGO_BOOK_ID\n\n\n@view\n@internal\ndef _getLegoBookAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LEGO_BOOK_ID)\n\n\n# switchboard\n\n\n@view\n@internal\ndef _getSwitchboardId() -> uint256:\n    return SWITCHBOARD_ID\n\n\n@view\n@internal\ndef _getSwitchboardAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(SWITCHBOARD_ID)\n\n\n# hatchery\n\n\n@view\n@internal\ndef _getHatcheryId() -> uint256:\n    return HATCHERY_ID\n\n\n@view\n@internal\ndef _getHatcheryAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(HATCHERY_ID)\n\n\n# loot distributor\n\n\n@view\n@internal\ndef _getLootDistributorId() -> uint256:\n    return LOOT_DISTRIBUTOR_ID\n\n\n@view\n@internal\ndef _getLootDistributorAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(LOOT_DISTRIBUTOR_ID)\n\n\n# appraiser\n\n\n@view\n@internal\ndef _getAppraiserId() -> uint256:\n    return APPRAISER_ID\n\n\n@view\n@internal\ndef _getAppraiserAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(APPRAISER_ID)\n\n\n# wallet backpack\n\n\n@view\n@internal\ndef _getWalletBackpackId() -> uint256:\n    return WALLET_BACKPACK_ID\n\n\n@view\n@internal\ndef _getWalletBackpackAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(WALLET_BACKPACK_ID)\n\n\n# billing\n\n\n@view\n@internal\ndef _getBillingId() -> uint256:\n    return BILLING_ID\n\n\n@view\n@internal\ndef _getBillingAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(BILLING_ID)\n\n\n# vault registry\n\n\n@view\n@internal\ndef _getVaultRegistryId() -> uint256:\n    return VAULT_REGISTRY_ID\n\n\n@view\n@internal\ndef _getVaultRegistryAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(VAULT_REGISTRY_ID)\n\n\n# helpers\n\n\n@view\n@internal\ndef _getHelpersId() -> uint256:\n    return HELPERS_ID\n\n\n@view\n@internal\ndef _getHelpersAddr() -> address:\n    return staticcall UndyHq(UNDY_HQ_FOR_ADDYS).getAddr(HELPERS_ID)",
            "sha256sum": "f550bb73a39fbf28fbeb23943f6c870a2f9a4263ded93b50950ed42ea0346155"
          },
          "contracts/vaults/LevgVaultHelper.vy": {
            "content": "#     Underscore Protocol License: https://github.com/underscore-finance/underscore-protocol/blob/master/LICENSE.md\n\n# @version 0.4.3\n\nexports: addys.__interface__\ninitializes: addys\nimport contracts.modules.Addys as addys\n\nfrom ethereum.ercs import IERC20\nfrom ethereum.ercs import IERC4626\n\ninterface LevgVault:\n    def vaultToLegoId(_vaultToken: address) -> uint256: view\n    def collateralAsset() -> RipeAsset: view\n    def leverageAsset() -> RipeAsset: view\n    def netUserCapital() -> uint256: view\n    def maxDebtRatio() -> uint256: view\n\ninterface YieldLego:\n    def getUnderlyingAmountSafe(_vaultToken: address, _vaultTokenBalance: uint256) -> uint256: view\n    def getUnderlyingAmount(_vaultToken: address, _vaultTokenAmount: uint256) -> uint256: view\n    def canRegisterVaultToken(_asset: address, _vaultToken: address) -> bool: view\n\ninterface RipePriceDesk:\n    def getAssetAmount(_asset: address, _usdValue: uint256, _shouldRaise: bool = False) -> uint256: view\n    def getUsdValue(_asset: address, _amount: uint256, _shouldRaise: bool = False) -> uint256: view\n\ninterface RipeMissionControl:\n    def isSupportedAssetInVault(_vaultId: uint256, _asset: address) -> bool: view\n    def getFirstVaultIdForAsset(_asset: address) -> uint256: view\n\ninterface RipeCreditEngine:\n    def getMaxBorrowAmount(_user: address) -> uint256: view\n    def getUserDebtAmount(_user: address) -> uint256: view\n\ninterface RipeRegistry:\n    def savingsGreen() -> address: view\n    def greenToken() -> address: view\n\ninterface RipeDepositVault:\n    def getTotalAmountForUser(_user: address, _asset: address) -> uint256: view\n\ninterface Ledger:\n    def vaultTokens(_vaultToken: address) -> VaultToken: view\n\ninterface Registry:\n    def getAddr(_regId: uint256) -> address: view\n\nstruct VaultToken:\n    legoId: uint256\n    underlyingAsset: address\n    decimals: uint256\n    isRebasing: bool\n\nstruct RipeAsset:\n    vaultToken: address\n    ripeVaultId: uint256\n\n# ripe addrs\nRIPE_REGISTRY: public(immutable(address))\nGREEN_TOKEN: public(immutable(address))\nSAVINGS_GREEN: public(immutable(address))\nUSDC: public(immutable(address))\n\nRIPE_MISSION_CONTROL_ID: constant(uint256) = 5\nRIPE_PRICE_DESK_ID: constant(uint256) = 7\nRIPE_VAULT_BOOK_ID: constant(uint256) = 8\nRIPE_CREDIT_ENGINE_ID: constant(uint256) = 13\nRIPE_DELEVERAGE_ID: constant(uint256) = 18\nSTAB_POOL_ID: constant(uint256) = 1\n\nHUNDRED_PERCENT: constant(uint256) = 100_00  # 100.00%\n\n\n@deploy\ndef __init__(_undyHq: address, _ripeRegistry: address, _usdc: address):\n    addys.__init__(_undyHq)\n\n    assert _ripeRegistry != empty(address) # dev: invalid ripe registry\n    RIPE_REGISTRY = _ripeRegistry\n    GREEN_TOKEN = staticcall RipeRegistry(RIPE_REGISTRY).greenToken()\n    SAVINGS_GREEN = staticcall RipeRegistry(RIPE_REGISTRY).savingsGreen()\n\n    assert _usdc != empty(address) # dev: invalid usdc\n    USDC = _usdc\n\n\n###################\n# Leverage Vaults #\n###################\n\n\n# pre swap validation\n\n\n@view\n@external\ndef getSwappableUsdcAmount(\n    _wallet: address,\n    _amountIn: uint256,\n    _currentBalance: uint256,\n    _leverageVaultToken: address,\n    _leverageVaultTokenLegoId: uint256,\n    _leverageVaultTokenRipeVaultId: uint256,\n    _usdc: address = empty(address),\n    _green: address = empty(address),\n    _savingsGreen: address = empty(address),\n    _legoBook: address = empty(address),\n) -> uint256:\n    # resolve addresses\n    ripeHq: address = self._getRipeHq()\n    ripeVaultBook: address = self._getRipeVaultBook(empty(address), ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(empty(address), ripeHq)\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n    ripePriceDesk: address = self._getRipePriceDesk(empty(address), ripeHq)\n\n    swappableAmount: uint256 = self._getSwappableUsdcAmount(_wallet, _leverageVaultToken, _leverageVaultTokenRipeVaultId, _usdc, _green, _savingsGreen, legoBook, ripeVaultBook, ripeMissionControl, creditEngine, ripePriceDesk)\n    return min(swappableAmount, _amountIn)\n\n\n# max borrow amount\n\n\n@view\n@external\ndef getMaxBorrowAmount(\n    _wallet: address,\n    _underlyingAsset: address,\n    _collateralVaultToken: address,\n    _collateralVaultTokenLegoId: uint256,\n    _collateralVaultTokenRipeVaultId: uint256,\n    _netUserCapital: uint256,\n    _maxDebtRatio: uint256,\n    _isUsdcVault: bool,\n    _legoBook: address = empty(address),\n) -> uint256:\n    # resolve addresses\n    ripeHq: address = self._getRipeHq()\n    ripeVaultBook: address = self._getRipeVaultBook(empty(address), ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(empty(address), ripeHq)\n    ripePriceDesk: address = self._getRipePriceDesk(empty(address), ripeHq)\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n\n    leverageAsset: RipeAsset = staticcall LevgVault(_wallet).leverageAsset()\n    maxDebtRatioLimit: uint256 = self._getMaxBorrowAmountByMaxDebtRatio(_wallet, _underlyingAsset, _collateralVaultToken, _collateralVaultTokenRipeVaultId, leverageAsset.vaultToken, _netUserCapital, _maxDebtRatio, legoBook, ripeVaultBook, ripeMissionControl, ripePriceDesk, creditEngine)\n    maxBorrowAmount: uint256 = self._getMaxBorrowAmountByRipeLtv(_wallet, creditEngine)\n    return min(maxDebtRatioLimit, maxBorrowAmount)\n\n\n# post swap validation\n\n\n@view\n@external\ndef performPostSwapValidation(\n    _tokenIn: address,\n    _tokenInAmount: uint256,\n    _tokenOut: address,\n    _tokenOutAmount: uint256,\n    _usdcSlippageAllowed: uint256,\n    _greenSlippageAllowed: uint256,\n    _usdc: address = empty(address),\n    _green: address = empty(address),\n) -> bool:\n    usdc: address = _usdc if _usdc != empty(address) else USDC\n    green: address = _green if _green != empty(address) else GREEN_TOKEN\n\n    # GREEN -> USDC swap validation\n    if _tokenIn == green and _tokenOut == usdc:\n\n        # Get USD value of USDC received (18 decimals)\n        ripePriceDesk: address = staticcall Registry(RIPE_REGISTRY).getAddr(RIPE_PRICE_DESK_ID)\n        usdcValue: uint256 = staticcall RipePriceDesk(ripePriceDesk).getUsdValue(usdc, _tokenOutAmount, True)\n\n        # Minimum expected: greenAmount * (10000 - slippage) / 10000\n        # GREEN is 18 decimals and treated as $1 USD, so greenAmount = USD value\n        minExpected: uint256 = _tokenInAmount * (HUNDRED_PERCENT - _usdcSlippageAllowed) // HUNDRED_PERCENT\n        return usdcValue >= minExpected\n\n    # USDC -> GREEN swap validation\n    elif _tokenIn == usdc and _tokenOut == green:\n\n        # Get USD value of USDC sent (18 decimals)\n        ripePriceDesk: address = staticcall Registry(RIPE_REGISTRY).getAddr(RIPE_PRICE_DESK_ID)\n        usdcValue: uint256 = staticcall RipePriceDesk(ripePriceDesk).getUsdValue(usdc, _tokenInAmount, True)\n\n        # Minimum expected: usdcValue * (10000 - slippage) / 10000\n        minExpected: uint256 = usdcValue * (HUNDRED_PERCENT - _greenSlippageAllowed) // HUNDRED_PERCENT\n        return _tokenOutAmount >= minExpected\n\n    return True\n\n\n# usdc vault\n\n\n@view\n@external\ndef getTotalAssetsForUsdcVault(\n    _wallet: address,\n    _collateralVaultToken: address,\n    _collateralVaultTokenLegoId: uint256,\n    _collateralVaultTokenRipeVaultId: uint256,\n    _leverageVaultToken: address,\n    _leverageVaultTokenLegoId: uint256,\n    _leverageVaultTokenRipeVaultId: uint256,\n    _shouldGetMax: bool = True,\n    _usdc: address = empty(address),\n    _green: address = empty(address),\n    _savingsGreen: address = empty(address),\n    _legoBook: address = empty(address),\n) -> uint256:\n    usdc: address = _usdc if _usdc != empty(address) else USDC\n    green: address = _green if _green != empty(address) else GREEN_TOKEN\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n\n    # resolve ripe addresses\n    ripeHq: address = self._getRipeHq()\n    ripeVaultBook: address = self._getRipeVaultBook(empty(address), ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(empty(address), ripeHq)\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n\n    # usdc amount: wallet + naked ripe + collateral vault\n    usdcAmount: uint256 = self._getTotalUnderlyingAmount(_wallet, _collateralVaultToken, True, _shouldGetMax, _collateralVaultTokenRipeVaultId, legoBook, ripeVaultBook, ripeMissionControl)\n\n    # add leverage vault amount if different from collateral vault\n    if _collateralVaultToken != _leverageVaultToken:\n        usdcAmount += self._getUnderlyingAmountForVaultToken(_wallet, _leverageVaultToken, _shouldGetMax, _leverageVaultTokenRipeVaultId, legoBook, ripeVaultBook, ripeMissionControl)\n\n    # green amounts\n    userDebtAmount: uint256 = staticcall RipeCreditEngine(creditEngine).getUserDebtAmount(_wallet) # 18 decimals\n    greenSurplusAmount: uint256 = self._getUnderlyingGreenAmount(_wallet, green, _savingsGreen, ripeVaultBook, ripeMissionControl)\n\n    # adjust usdc values based on green situation\n    if userDebtAmount > greenSurplusAmount:\n        userDebtAmount -= greenSurplusAmount # treat green as $1 USD (most conservative, in this case)\n        usdcAmount -= min(usdcAmount, userDebtAmount // (10 ** 12)) # normalize to 6 decimals\n\n    elif greenSurplusAmount > userDebtAmount:\n        ripePriceDesk: address = self._getRipePriceDesk(empty(address), ripeHq)\n        extraGreen: uint256 = greenSurplusAmount - userDebtAmount\n        usdValueOfGreen: uint256 = min(staticcall RipePriceDesk(ripePriceDesk).getUsdValue(green, extraGreen, True), extraGreen) # both 18 decimals\n        usdcAmount += staticcall RipePriceDesk(ripePriceDesk).getAssetAmount(usdc, usdValueOfGreen, True)\n\n    return usdcAmount\n\n\n# non-usdc vault\n\n\n@view\n@external\ndef getTotalAssetsForNonUsdcVault(\n    _wallet: address,\n    _underlyingAsset: address,\n    _collateralVaultToken: address,\n    _collateralVaultTokenLegoId: uint256,\n    _collateralVaultTokenRipeVaultId: uint256,\n    _leverageVaultToken: address,\n    _leverageVaultTokenLegoId: uint256,\n    _leverageVaultTokenRipeVaultId: uint256,\n    _shouldGetMax: bool = True,\n    _usdc: address = empty(address),\n    _green: address = empty(address),\n    _savingsGreen: address = empty(address),\n    _legoBook: address = empty(address),\n) -> uint256:\n    usdc: address = _usdc if _usdc != empty(address) else USDC\n    green: address = _green if _green != empty(address) else GREEN_TOKEN\n    legoBook: address = _legoBook if _legoBook != empty(address) else addys._getLegoBookAddr()\n\n    # resolve ripe addresses\n    ripeHq: address = self._getRipeHq()\n    ripeVaultBook: address = self._getRipeVaultBook(empty(address), ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(empty(address), ripeHq)\n    creditEngine: address = self._getRipeCreditEngine(empty(address), ripeHq)\n    ripePriceDesk: address = self._getRipePriceDesk(empty(address), ripeHq)\n\n    # phase 1: get underlying asset amount (WETH/CBBTC/etc) - from wallet + naked ripe + collateral vault\n    underlyingAmount: uint256 = self._getTotalUnderlyingAmount(_wallet, _collateralVaultToken, True, _shouldGetMax, _collateralVaultTokenRipeVaultId, legoBook, ripeVaultBook, ripeMissionControl)\n\n    # phase 2: get USDC (wallet + naked on ripe + leverage vault)\n    usdcAmount: uint256 = self._getTotalUnderlyingAmount(_wallet, _leverageVaultToken, False, _shouldGetMax, _leverageVaultTokenRipeVaultId, legoBook, ripeVaultBook, ripeMissionControl)\n    usdcValue: uint256 = staticcall RipePriceDesk(ripePriceDesk).getUsdValue(usdc, usdcAmount, True) # 18 decimals\n\n    # phase 3: calculate GREEN position\n    userDebtAmount: uint256 = staticcall RipeCreditEngine(creditEngine).getUserDebtAmount(_wallet) # 18 decimals\n    greenSurplusAmount: uint256 = self._getUnderlyingGreenAmount(_wallet, green, _savingsGreen, ripeVaultBook, ripeMissionControl)\n\n    # phase 4: convert (USDC +/- GREEN) to underlying asset and add/subtract\n    if userDebtAmount > greenSurplusAmount:\n\n        # net debt scenario: we owe GREEN\n        netDebt: uint256 = userDebtAmount - greenSurplusAmount # 18 decimals, treat GREEN as $1 USD (most conservative, in this case)\n\n        # USDC covers debt with surplus\n        if usdcValue > netDebt:\n            netPositiveValue: uint256 = usdcValue - netDebt\n            underlyingAmount += staticcall RipePriceDesk(ripePriceDesk).getAssetAmount(_underlyingAsset, netPositiveValue, True)\n\n        # debt exceeds USDC value - leverage vault is underwater\n        else:\n            netNegativeValue: uint256 = netDebt - usdcValue\n            underlyingToSubtract: uint256 = staticcall RipePriceDesk(ripePriceDesk).getAssetAmount(_underlyingAsset, netNegativeValue, True)\n            underlyingAmount -= min(underlyingAmount, underlyingToSubtract)\n\n    else:\n        extraGreen: uint256 = greenSurplusAmount - userDebtAmount # net surplus scenario: we have extra GREEN (or zero)\n        greenValue: uint256 = min(staticcall RipePriceDesk(ripePriceDesk).getUsdValue(green, extraGreen, True), extraGreen) # both 18 decimals\n        totalPositiveValue: uint256 = usdcValue + greenValue\n        underlyingAmount += staticcall RipePriceDesk(ripePriceDesk).getAssetAmount(_underlyingAsset, totalPositiveValue, True)\n\n    return underlyingAmount\n\n\n# collateral balance\n\n\n@view\n@external\ndef getCollateralBalance(_user: address, _asset: address, _ripeVaultId: uint256, _vaultBook: address = empty(address)) -> uint256:\n    ripeHq: address = self._getRipeHq()\n    ripeVaultBook: address = self._getRipeVaultBook(_vaultBook, ripeHq)\n    ripeMissionControl: address = self._getRipeMissionControl(empty(address), ripeHq)\n    return self._getRipeCollateralBalance(_user, _asset, _ripeVaultId, ripeVaultBook, ripeMissionControl)\n\n\n# supported asset\n\n\n@view\n@external\ndef isSupportedAssetInVault(_vaultId: uint256, _asset: address) -> bool:\n    return self._isSupportedAssetInVault(_vaultId, _asset)\n\n\n@view\n@internal\ndef _isSupportedAssetInVault(_vaultId: uint256, _asset: address) -> bool:\n    mc: address = staticcall Registry(RIPE_REGISTRY).getAddr(RIPE_MISSION_CONTROL_ID)\n    return staticcall RipeMissionControl(mc).isSupportedAssetInVault(_vaultId, _asset)\n\n\n# get addrs\n\n\n@view\n@external\ndef getVaultBookAndDeleverage() -> (address, address):\n    ripeHq: address = RIPE_REGISTRY\n    vaultBook: address = staticcall Registry(ripeHq).getAddr(RIPE_VAULT_BOOK_ID)\n    deleverage: address = staticcall Registry(ripeHq).getAddr(RIPE_DELEVERAGE_ID)\n    return vaultBook, deleverage\n\n\n# validate vault token\n\n\n@view\n@external\ndef isValidVaultToken(_underlyingAsset: address, _vaultToken: address, _ripeVaultId: uint256, _legoId: uint256) -> bool:\n    if empty(address) in [_underlyingAsset, _vaultToken]:\n        return False\n\n    if 0 in [_ripeVaultId, _legoId]:\n        return False\n\n    # check lego id\n    legoAddr: address = staticcall Registry(addys._getLegoBookAddr()).getAddr(_legoId)\n    if not staticcall YieldLego(legoAddr).canRegisterVaultToken(_underlyingAsset, _vaultToken):\n        return False\n\n    # check ripe collateral asset\n    return self._isSupportedAssetInVault(_ripeVaultId, _vaultToken)\n\n\n#####################\n# Core Internal Fns #\n#####################\n\n\n# Everything below here is the exact same as in LevgVaultTools.vy\n\n\n@view\n@internal\ndef _getVaultTokenData(_levgVault: address, _isCollateralAsset: bool) -> (address, uint256):\n    assetData: RipeAsset = empty(RipeAsset)\n    if _isCollateralAsset:\n        assetData = staticcall LevgVault(_levgVault).collateralAsset()\n    else:\n        assetData = staticcall LevgVault(_levgVault).leverageAsset()\n    return assetData.vaultToken, assetData.ripeVaultId\n\n\n@view\n@internal\ndef _getLegoIdForVaultToken(_levgVault: address, _vaultToken: address, _undyVaultTokenLegoId: uint256 = 0) -> uint256:\n    if _undyVaultTokenLegoId != 0:\n        return _undyVaultTokenLegoId\n\n    legoId: uint256 = staticcall LevgVault(_levgVault).vaultToLegoId(_vaultToken)\n    if legoId != 0:\n        return legoId\n\n    data: VaultToken = staticcall Ledger(addys._getLedgerAddr()).vaultTokens(_vaultToken)\n    return data.legoId\n\n\n@view\n@internal\ndef _getRipeCollateralBalance(\n    _levgVault: address,\n    _asset: address,\n    _ripeVaultId: uint256,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    ripeVaultId: uint256 = _ripeVaultId\n\n    # get ripe vault id (if necessary)\n    if ripeVaultId == 0:\n        ripeVaultId = staticcall RipeMissionControl(_ripeMissionControl).getFirstVaultIdForAsset(_asset)\n\n    # no ripe vault id found\n    if ripeVaultId == 0:\n        return 0\n\n    # get ripe vault deposit address\n    ripeVaultAddr: address = staticcall Registry(_ripeVaultBook).getAddr(ripeVaultId)\n    if ripeVaultAddr == empty(address):\n        return 0\n\n    # get total amount for user\n    return staticcall RipeDepositVault(ripeVaultAddr).getTotalAmountForUser(_levgVault, _asset)\n\n\n@view\n@internal\ndef _getAmountForAsset(\n    _levgVault: address,\n    _asset: address,\n    _ripeVaultId: uint256,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    if _asset == empty(address):\n        return 0\n\n    # asset in wallet\n    amount: uint256 = staticcall IERC20(_asset).balanceOf(_levgVault)\n\n    # asset on Ripe\n    amount += self._getRipeCollateralBalance(_levgVault, _asset, _ripeVaultId, _ripeVaultBook, _ripeMissionControl)\n\n    return amount\n\n\n@view\n@internal\ndef _getUnderlyingAmountWithVaultTokenAmount(\n    _levgVault: address,\n    _vaultToken: address,\n    _vaultTokenAmount: uint256,\n    _shouldGetMax: bool,\n    _undyVaultTokenLegoId: uint256,\n    _legoBook: address,\n) -> uint256:\n    # get lego id (if necessary)\n    legoId: uint256 = self._getLegoIdForVaultToken(_levgVault, _vaultToken, _undyVaultTokenLegoId)\n    if legoId == 0:\n        return 0\n\n    # underscore lego address\n    legoAddr: address = staticcall Registry(_legoBook).getAddr(legoId)\n    if legoAddr == empty(address):\n        return 0\n\n    # calc underlying amount\n    underlyingAmount: uint256 = 0\n    if _shouldGetMax:\n        underlyingAmount = staticcall YieldLego(legoAddr).getUnderlyingAmount(_vaultToken, _vaultTokenAmount)\n    else:\n        underlyingAmount = staticcall YieldLego(legoAddr).getUnderlyingAmountSafe(_vaultToken, _vaultTokenAmount)\n\n    return underlyingAmount\n\n\n@view\n@internal\ndef _getUnderlyingAmountForVaultToken(\n    _levgVault: address,\n    _vaultToken: address,\n    _shouldGetMax: bool,\n    _ripeVaultId: uint256,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    if _vaultToken == empty(address):\n        return 0\n\n    # get vault token amount (in wallet and on ripe)\n    vaultTokenAmount: uint256 = self._getAmountForAsset(_levgVault, _vaultToken, _ripeVaultId, _ripeVaultBook, _ripeMissionControl)\n    if vaultTokenAmount == 0:\n        return 0\n\n    # get underlying amount with vault token amount\n    return self._getUnderlyingAmountWithVaultTokenAmount(_levgVault, _vaultToken, vaultTokenAmount, _shouldGetMax, 0, _legoBook)\n\n\n@view\n@internal\ndef _getTotalUnderlyingAmount(\n    _levgVault: address,\n    _vaultToken: address,\n    _isCollateralAsset: bool,\n    _shouldGetMax: bool,\n    _ripeVaultId: uint256,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    underlyingAsset: address = staticcall IERC4626(_levgVault).asset() if _isCollateralAsset else USDC\n    underlyingNaked: uint256 = self._getAmountForAsset(_levgVault, underlyingAsset, 0, _ripeVaultBook, _ripeMissionControl)\n    underlyingFromVault: uint256 = self._getUnderlyingAmountForVaultToken(_levgVault, _vaultToken, _shouldGetMax, _ripeVaultId, _legoBook, _ripeVaultBook, _ripeMissionControl)\n    return underlyingNaked + underlyingFromVault\n\n\n@view\n@internal\ndef _getUnderlyingGreenAmount(\n    _levgVault: address,\n    _green: address,\n    _savingsGreen: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n) -> uint256:\n    green: address = _green if _green != empty(address) else GREEN_TOKEN\n    greenAmount: uint256 = staticcall IERC20(green).balanceOf(_levgVault)\n\n    # savings green balance (in wallet and on ripe)\n    savingsGreen: address = _savingsGreen if _savingsGreen != empty(address) else SAVINGS_GREEN\n    savingsGreenAmount: uint256 = self._getAmountForAsset(_levgVault, savingsGreen, STAB_POOL_ID, _ripeVaultBook, _ripeMissionControl)\n\n    # calc underlying amount\n    if savingsGreenAmount != 0:\n        greenAmount += staticcall IERC4626(savingsGreen).previewRedeem(savingsGreenAmount)\n\n    return greenAmount\n\n\n@view\n@internal\ndef _getMaxBorrowAmountByMaxDebtRatio(\n    _levgVault: address,\n    _underlyingAsset: address,\n    _collateralVaultToken: address,\n    _collateralVaultTokenRipeVaultId: uint256,\n    _leverageVaultToken: address,\n    _netUserCapital: uint256,\n    _maxDebtRatio: uint256,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n    _ripePriceDesk: address,\n    _creditEngine: address,\n) -> uint256:\n    # get max debt ratio (if necessary) -- check early to avoid expensive calculations\n    maxDebtRatio: uint256 = _maxDebtRatio if _maxDebtRatio != 0 else staticcall LevgVault(_levgVault).maxDebtRatio()\n    if maxDebtRatio == 0:\n        return max_value(uint256)\n\n    # get leverage vault token (if necessary)\n    leverageVaultToken: address = _leverageVaultToken\n    if leverageVaultToken == empty(address):\n        levgData: RipeAsset = staticcall LevgVault(_levgVault).leverageAsset()\n        leverageVaultToken = levgData.vaultToken\n\n    collateralVaultToken: address = _collateralVaultToken\n    collateralVaultTokenRipeVaultId: uint256 = _collateralVaultTokenRipeVaultId\n    if collateralVaultToken == empty(address) or collateralVaultTokenRipeVaultId == 0:\n        levgData: RipeAsset = staticcall LevgVault(_levgVault).collateralAsset()\n        collateralVaultToken = levgData.vaultToken\n        collateralVaultTokenRipeVaultId = levgData.ripeVaultId\n\n    # for usdc leverage vaults, use netUserCapital only (otherwise can't distinguish user capital from leveraged positions)\n    underlyingAmount: uint256 = 0\n    if collateralVaultToken == leverageVaultToken:\n        underlyingAmount = _netUserCapital if _netUserCapital != 0 else staticcall LevgVault(_levgVault).netUserCapital()\n\n    # typical leverage vault\n    else:\n        underlyingAmount = self._getTotalUnderlyingAmount(\n            _levgVault,\n            collateralVaultToken,\n            True, # is collateral asset\n            False, # conservative, safe underlying amount\n            collateralVaultTokenRipeVaultId,\n            _legoBook,\n            _ripeVaultBook,\n            _ripeMissionControl,\n        )\n\n    # get underlying asset (if necessary)\n    underlyingAsset: address = _underlyingAsset if _underlyingAsset != empty(address) else staticcall IERC4626(_levgVault).asset()\n\n    # convert to USD value\n    underlyingUsdValue: uint256 = staticcall RipePriceDesk(_ripePriceDesk).getUsdValue(underlyingAsset, underlyingAmount, True)\n\n    # current debt amount (in GREEN, 18 decimals, treated as $1 USD)\n    currentDebt: uint256 = staticcall RipeCreditEngine(_creditEngine).getUserDebtAmount(_levgVault)\n\n    # user's GREEN can offset debt (GREEN is 18 decimals, treated as $1 USD)\n    greenAmount: uint256 = self._getUnderlyingGreenAmount(_levgVault, empty(address), empty(address), _ripeVaultBook, _ripeMissionControl)\n    remainingDebt: uint256 = 0\n    if currentDebt > greenAmount:\n        remainingDebt = currentDebt - greenAmount\n\n    # max allowed debt (in USD)\n    maxAllowedDebt: uint256 = underlyingUsdValue * maxDebtRatio // HUNDRED_PERCENT\n    if remainingDebt >= maxAllowedDebt:\n        return 0\n\n    return maxAllowedDebt - remainingDebt\n\n\n@view\n@internal\ndef _getMaxBorrowAmountByRipeLtv(\n    _levgVault: address,\n    _creditEngine: address,\n) -> uint256:\n    return staticcall RipeCreditEngine(_creditEngine).getMaxBorrowAmount(_levgVault)\n\n\n@view\n@internal\ndef _getSwappableUsdcAmount(\n    _levgVault: address,\n    _leverageVaultToken: address,\n    _leverageVaultTokenRipeVaultId: uint256,\n    _usdc: address,\n    _green: address,\n    _savingsGreen: address,\n    _legoBook: address,\n    _ripeVaultBook: address,\n    _ripeMissionControl: address,\n    _creditEngine: address,\n    _ripePriceDesk: address,\n) -> uint256:\n    usdc: address = _usdc if _usdc != empty(address) else USDC\n\n    # core underlying asset must be different from USDC\n    if staticcall IERC4626(_levgVault).asset() == usdc:\n        return 0\n\n    # get leverage vault token data (if necessary)\n    leverageVaultToken: address = _leverageVaultToken\n    leverageVaultTokenRipeVaultId: uint256 = _leverageVaultTokenRipeVaultId\n    if leverageVaultToken == empty(address) or leverageVaultTokenRipeVaultId == 0:\n        levgData: RipeAsset = staticcall LevgVault(_levgVault).leverageAsset()\n        leverageVaultToken = levgData.vaultToken\n        leverageVaultTokenRipeVaultId = levgData.ripeVaultId\n\n    # leverage vault token must be USDC\n    if staticcall IERC4626(leverageVaultToken).asset() != usdc:\n        return 0\n\n    # total usdc amount (in wallet, naked on ripe, via vault token)\n    usdcAmount: uint256 = self._getTotalUnderlyingAmount(_levgVault, leverageVaultToken, False, False, leverageVaultTokenRipeVaultId, _legoBook, _ripeVaultBook, _ripeMissionControl)\n\n    # user debt amount\n    userDebtAmount: uint256 = staticcall RipeCreditEngine(_creditEngine).getUserDebtAmount(_levgVault) # 18 decimals\n    if userDebtAmount == 0:\n        return usdcAmount\n\n    # convert to USD value\n    usdcValue: uint256 = staticcall RipePriceDesk(_ripePriceDesk).getUsdValue(usdc, usdcAmount, False) # 18 decimals\n\n    # green amount (treat as $1 USD to offset debt)\n    greenSurplusAmount: uint256 = self._getUnderlyingGreenAmount(_levgVault, _green, _savingsGreen, _ripeVaultBook, _ripeMissionControl)\n\n    # if GREEN covers all debt, all USDC is swappable\n    if greenSurplusAmount >= userDebtAmount:\n        return usdcAmount\n\n    # remaining debt must come from USDC\n    remainingDebt: uint256 = userDebtAmount - greenSurplusAmount\n    if remainingDebt >= usdcValue:\n        return 0\n\n    return staticcall RipePriceDesk(_ripePriceDesk).getAssetAmount(usdc, usdcValue - remainingDebt, True)\n\n\n#####################\n# Address Resolvers #\n#####################\n\n\n@view\n@internal\ndef _getRipeHq(_ripeHq: address = empty(address)) -> address:\n    if _ripeHq != empty(address):\n        return _ripeHq\n    return RIPE_REGISTRY\n\n\n@view\n@internal\ndef _getRipeVaultBook(_ripeVaultBook: address = empty(address), _ripeHq: address = empty(address)) -> address:\n    if _ripeVaultBook != empty(address):\n        return _ripeVaultBook\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    return staticcall Registry(ripeHq).getAddr(RIPE_VAULT_BOOK_ID)\n\n\n@view\n@internal\ndef _getRipeMissionControl(_ripeMissionControl: address = empty(address), _ripeHq: address = empty(address)) -> address:\n    if _ripeMissionControl != empty(address):\n        return _ripeMissionControl\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    return staticcall Registry(ripeHq).getAddr(RIPE_MISSION_CONTROL_ID)\n\n\n@view\n@internal\ndef _getRipeCreditEngine(_ripeCreditEngine: address = empty(address), _ripeHq: address = empty(address)) -> address:\n    if _ripeCreditEngine != empty(address):\n        return _ripeCreditEngine\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    return staticcall Registry(ripeHq).getAddr(RIPE_CREDIT_ENGINE_ID)\n\n\n@view\n@internal\ndef _getRipePriceDesk(_ripePriceDesk: address = empty(address), _ripeHq: address = empty(address)) -> address:\n    if _ripePriceDesk != empty(address):\n        return _ripePriceDesk\n    ripeHq: address = self._getRipeHq(_ripeHq)\n    return staticcall Registry(ripeHq).getAddr(RIPE_PRICE_DESK_ID)",
            "sha256sum": "29934f234e6523cb9f4fb7041115a6ffb65328d95aeb77f7ebcd18277cf324eb"
          }
        },
        "settings": {
          "outputSelection": {
            "contracts/vaults/LevgVaultHelper.vy": [
              "*"
            ]
          },
          "search_paths": [
            "."
          ]
        },
        "compiler_version": "v0.4.3+commit.bff19ea2",
        "integrity": "2ee52279dfbf13ad4d0fc66e09275b3ada6891b388df8a7a2e4d6ab074a42e95"
      },
      "args": "00000000000000000000000044cf3c4f000dfd76a35d03298049d37be688d6f90000000000000000000000006162df1b329e157479f8f1407e888260e0ec3d2b000000000000000000000000833589fcd6edb6e08f4c7c32d4f71b54bda02913",
      "file": "contracts/vaults/LevgVaultHelper.vy"
    }
  }
}